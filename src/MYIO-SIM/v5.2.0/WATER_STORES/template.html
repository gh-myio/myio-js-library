<section class="water-stores-root" id="waterStoresWrap">
  <!-- RFC-0087: Water Stores widget based on STORES -->

  <!-- Water Stores Statistics Header -->
  <div
    class="water-stats-header"
    id="waterStoresStatsHeader"
    style="display: flex !important; flex-direction: row !important"
  >
    <div class="stat-item">
      <span class="stat-label">Conectividade</span>
      <span class="stat-value" id="waterStoresStatsConnectivity">-</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">Total de Lojas</span>
      <span class="stat-value" id="waterStoresStatsTotal">-</span>
    </div>
    <div class="stat-item highlight">
      <span class="stat-label">Consumo Total de Água</span>
      <span class="stat-value" id="waterStoresStatsConsumption">-</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">Sem Consumo</span>
      <span class="stat-value" id="waterStoresStatsZero">-</span>
    </div>

    <!-- Filter Actions -->
    <div class="filter-actions">
      <div class="search-wrap" id="searchWrap">
        <input type="text" id="waterStoresSearch" placeholder="Buscar loja..." autocomplete="off" />
      </div>
      <button class="icon-btn" id="btnSearch" title="Buscar" aria-label="Buscar">
        <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
          <path
            d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.5 21.5 20l-6-6zM4 9.5C4 6.46 6.46 4 9.5 4S15 6.46 15 9.5 12.54 15 9.5 15 4 12.54 4 9.5z"
          />
        </svg>
      </button>
      <button class="icon-btn" id="btnFilter" title="Filtros" aria-label="Filtros">
        <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
          <path d="M3 4h18l-7 8v6l-4 2v-8L3 4z" />
        </svg>
      </button>
    </div>
  </div>

  <section id="waterStoresList" class="water-stores-list"></section>

  <!-- Modal de filtros -->
  <div
    id="filterModal"
    class="water-stores-modal hidden"
    role="dialog"
    aria-modal="true"
    aria-labelledby="filterTitle"
  >
    <div class="water-stores-modal-card">
      <header class="water-stores-modal-header">
        <h3 id="filterTitle">Selecionar Lojas</h3>
        <button class="icon-btn" id="closeFilter" aria-label="Fechar">
          <svg viewBox="0 0 24 24" width="18" height="18">
            <path
              d="M18.3 5.71 12 12l6.3 6.29-1.41 1.42L10.59 13.4 4.29 19.7 2.88 18.29 9.17 12 2.88 5.71 4.29 4.3l6.3 6.29 6.29-6.3z"
            />
          </svg>
        </button>
      </header>

      <section class="water-stores-modal-body">
        <div class="filter-block">
          <div class="filter-tabs" id="filterTabs">
            <button class="filter-tab active" data-filter="all">TODOS (<span id="countAll">0</span>)</button>
            <button class="filter-tab" data-filter="online">ONLINE (<span id="countOnline">0</span>)</button>
            <button class="filter-tab" data-filter="offline">
              OFFLINE (<span id="countOffline">0</span>)
            </button>
            <button class="filter-tab" data-filter="with-consumption">
              COM CONSUMO (<span id="countWithConsumption">0</span>)
            </button>
            <button class="filter-tab" data-filter="no-consumption">
              SEM CONSUMO (<span id="countNoConsumption">0</span>)
            </button>
          </div>

          <div class="filter-search">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path
                d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.5 21.5 20l-6-6zM4 9.5C4 6.46 6.46 4 9.5 4S15 6.46 15 9.5 12.54 15 9.5 15 4 12.54 4 9.5z"
              />
            </svg>
            <input id="filterDeviceSearch" type="text" placeholder="Buscar lojas..." autocomplete="off" />
            <button class="clear-x" id="filterDeviceClear" title="Limpar" aria-label="Limpar">
              <svg viewBox="0 0 24 24" width="14" height="14">
                <path
                  d="M18.3 5.71 12 12l6.3 6.29-1.41 1.42L10.59 13.4 4.29 19.7 2.88 18.29 9.17 12 2.88 5.71 4.29 4.3l6.3 6.29 6.29-6.3z"
                />
              </svg>
            </button>
          </div>
          <div id="deviceChecklist" class="checklist" role="listbox" aria-multiselectable="true"></div>
        </div>

        <div class="filter-block">
          <label class="block-label">Ordenação</label>
          <div class="radio-grid">
            <label><input type="radio" name="sortMode" value="cons_desc" checked /> Consumo ↓ (padrão)</label>
            <label><input type="radio" name="sortMode" value="cons_asc" /> Consumo ↑</label>
            <label><input type="radio" name="sortMode" value="alpha_asc" /> A → Z</label>
            <label><input type="radio" name="sortMode" value="alpha_desc" /> Z → A</label>
          </div>
          <p class="muted">Caso o consumo seja o mesmo é considerada a ordem alfabética.</p>
        </div>
      </section>

      <footer class="water-stores-modal-footer">
        <button id="applyFilters" class="btn primary">Aplicar</button>
        <button id="resetFilters" class="btn">Resetar</button>
      </footer>
    </div>
  </div>
</section>
