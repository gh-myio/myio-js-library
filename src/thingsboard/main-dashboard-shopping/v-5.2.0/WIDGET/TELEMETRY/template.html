<section class="shops-root">
  <header class="shops-header">
    <div class="shops-header-left">
      <span
        class="temp-info-trigger"
        id="tempInfoTrigger"
        style="display: none"
        title="Detalhes de Temperatura"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
      </span>
      <h2 class="shops-title" id="labelWidgetId"></h2>
      <span class="shops-count" id="shopsCount">(0)</span>
    </div>

    <div class="shops-header-actions">
      <div class="search-wrap" id="searchWrap">
        <input type="text" id="shopsSearch" placeholder="Buscar..." autocomplete="off" />
      </div>

      <button class="icon-btn" id="btnSearch" title="Buscar" aria-label="Buscar">
        <!-- Lupa -->
        <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
          <path
            d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.5 21.5 20l-6-6zM4 9.5C4 6.46 6.46 4 9.5 4S15 6.46 15 9.5 12.54 15 9.5 15 4 12.54 4 9.5z"
          />
        </svg>
      </button>

      <button class="icon-btn" id="btnFilter" title="Filtros" aria-label="Filtros">
        <!-- Funil -->
        <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
          <path d="M3 4h18l-7 8v6l-4 2v-8L3 4z" />
        </svg>
      </button>

      <a class="shops-total" id="shopsTotal">0,00</a>
    </div>
  </header>

  <section id="shopsList" class="shops-list"></section>

  <!-- Modal de filtros — classe telemetry-filter-overlay garante position:fixed relativo ao viewport mesmo com transforms do TB -->
  <div
    id="filterModal"
    class="shops-modal telemetry-filter-overlay hidden"
    role="dialog"
    aria-modal="true"
    aria-labelledby="filterTitle"
  >
    <div class="shops-modal-card">
      <header class="shops-modal-header">
        <h3 id="filterTitle">Filtros & Ordenação</h3>
        <button class="icon-btn" id="closeFilter" aria-label="Fechar">
          <svg viewBox="0 0 24 24" width="18" height="18">
            <path
              d="M18.3 5.71 12 12l6.3 6.29-1.41 1.42L10.59 13.4 4.29 19.7 2.88 18.29 9.17 12 2.88 5.71 4.29 4.3l6.3 6.29 6.29-6.3z"
            />
          </svg>
        </button>
      </header>

      <section class="shops-modal-body">
        <div class="filter-block">
          <label class="block-label">Filtro de Alarmes</label>
          <div class="radio-grid alarm-filter-grid">
            <label><input type="radio" name="alarmFilter" value="ativado" checked /> Ativado (todos visíveis)</label>
            <label><input type="radio" name="alarmFilter" value="apenas_ativados" /> Apenas com alarmes</label>
            <label><input type="radio" name="alarmFilter" value="desativado" /> Desativado (sem badges)</label>
          </div>
          <p class="muted">Em <strong>Apenas com alarmes</strong> somente cards com alarme ativo são exibidos.</p>
        </div>

        <div class="filter-block">
          <label class="block-label">Ordenação</label>
          <div class="radio-grid">
            <label><input type="radio" name="sortMode" value="cons_desc" checked /> Consumo ↓ (padrão)</label>
            <label><input type="radio" name="sortMode" value="cons_asc" /> Consumo ↑</label>
            <label><input type="radio" name="sortMode" value="alpha_asc" /> A → Z</label>
            <label><input type="radio" name="sortMode" value="alpha_desc" /> Z → A</label>
          </div>
          <p class="muted">Caso o consumo seja o mesmo é considerada a ordem alfabética.</p>
        </div>

        <div class="filter-block">
          <label class="block-label">Selecionar Lojas</label>
          <div class="inline-actions">
            <button id="selectAll" class="tiny-btn">Selecionar todas</button>
            <button id="clearAll" class="tiny-btn">Limpar</button>
          </div>

          <div class="filter-search">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path
                d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.5 21.5 20l-6-6zM4 9.5C4 6.46 6.46 4 9.5 4S15 6.46 15 9.5 12.54 15 9.5 15 4 12.54 4 9.5z"
              />
            </svg>
            <input id="filterDeviceSearch" type="text" placeholder="Buscar lojas..." autocomplete="off" />
            <button class="clear-x" id="filterDeviceClear" title="Limpar" aria-label="Limpar">
              <!-- X -->
              <svg viewBox="0 0 24 24" width="14" height="14">
                <path
                  d="M18.3 5.71 12 12l6.3 6.29-1.41 1.42L10.59 13.4 4.29 19.7 2.88 18.29 9.17 12 2.88 5.71 4.29 4.3l6.3 6.29 6.29-6.3z"
                />
              </svg>
            </button>
          </div>
          <div id="deviceChecklist" class="checklist" role="listbox" aria-multiselectable="true"></div>
        </div>
      </section>

      <footer class="shops-modal-footer">
        <button id="applyFilters" class="btn primary">Aplicar</button>
        <button id="resetFilters" class="btn">Resetar</button>
      </footer>
    </div>
  </div>
</section>
