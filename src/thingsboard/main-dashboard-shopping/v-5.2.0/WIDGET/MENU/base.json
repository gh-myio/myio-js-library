{
  "entityType": "WIDGET_TYPE",
  "entity": {
    "fqn": "widget_shopping_dashboard_menu_v_5_2_0",
    "name": "Widget - Shopping Dashboard - MENU - v.5.2.0",
    "deprecated": false,
    "image": null,
    "description": null,
    "descriptor": {
      "type": "latest",
      "sizeX": 7.5,
      "sizeY": 3,
      "resources": [],
      "templateHtml": "<section class=\"shops-menu-root\">\r\n  <div class=\"user-info\" id=\"user-info\">\r\n    <div class=\"user-name\" id=\"user-name\">Carregando...</div>\r\n    <div class=\"user-email\" id=\"user-email\"></div>\r\n  </div>\r\n\r\n  <div class=\"menu-header\">\r\n    <button class=\"hamburger-btn\">‚ò∞ Menu</button>\r\n  </div>\r\n\r\n  <nav class=\"menu-list\">\r\n    <a\r\n      href=\"#\"\r\n      *ngFor=\"let link of links; let i = index\"\r\n      id=\"link{{ i }}\"\r\n      class=\"menu-item\"\r\n      (click)=\"changeDashboardState($event, link.stateId, i)\"\r\n      [class.active]=\"link.enableLink\"\r\n      [attr.data-icon]=\"getMenuIcon(link.stateId)\"\r\n    >\r\n      <span class=\"menu-icon\">{{ getMenuIcon(link.stateId) }}</span>\r\n      <span class=\"label\">{{ link.content }}</span>\r\n    </a>\r\n  </nav>\r\n\r\n  <div class=\"menu-footer\">\r\n    <button\r\n      id=\"logout-btn\"\r\n      class=\"logout-btn\"\r\n      (click)=\"handleLogout($event)\"\r\n      title=\"Sair do sistema\"\r\n    >\r\n      <span class=\"logout-icon\">üö™</span>\r\n      <span class=\"logout-text\">Sair</span>\r\n    </button>\r\n  </div>\r\n</section>\r\n",
      "templateCss": ".shopping-modal {\r\n  position: fixed;\r\n  inset: 0;\r\n  z-index: 9999;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  opacity: 0;\r\n  pointer-events: none;\r\n  transition: opacity .2s ease;\r\n  font-family: \"Inter\", sans-serif;\r\n}\r\n\r\n.shopping-modal.show {\r\n  opacity: 1;\r\n  pointer-events: auto;\r\n}\r\n\r\n.shopping-modal-overlay {\r\n  position: absolute;\r\n  inset: 0;\r\n  background: rgba(0,0,0,0.45);\r\n  backdrop-filter: blur(3px);\r\n}\r\n\r\n.shopping-modal-window {\r\n  position: relative;\r\n  z-index: 2;\r\n  background: #fff;\r\n  width: 400px;\r\n  max-width: 90%;\r\n  border-radius: 16px;\r\n  box-shadow: 0 8px 30px rgba(0,0,0,0.2);\r\n  overflow: hidden;\r\n  transform: translateY(-10px);\r\n  transition: transform .25s ease;\r\n}\r\n\r\n.shopping-modal.show .shopping-modal-window {\r\n  transform: translateY(0);\r\n}\r\n\r\n.shopping-modal-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  background: #5B3CC4;\r\n  color: #fff;\r\n  padding: 12px 18px;\r\n}\r\n\r\n.shopping-modal-header h3 {\r\n  font-size: 1.1rem;\r\n  margin: 0;\r\n}\r\n\r\n.close-btn {\r\n  background: none;\r\n  border: none;\r\n  color: #fff;\r\n  font-size: 22px;\r\n  cursor: pointer;\r\n  transition: transform .2s;\r\n}\r\n\r\n.close-btn:hover {\r\n  transform: scale(1.1);\r\n}\r\n\r\n.shopping-modal-body {\r\n  padding: 16px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10px;\r\n}\r\n\r\n.shopping-option {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 10px;\r\n  padding: 10px 14px;\r\n  cursor: pointer;\r\n  transition: all .2s;\r\n  background: #fafafa;\r\n}\r\n\r\n.shopping-option:hover {\r\n  background: #f3ebff;\r\n  border-color: #7b5dfb;\r\n  transform: scale(1.02);\r\n}\r\n\r\n.shopping-icon {\r\n  font-size: 26px;\r\n}\r\n\r\n.shopping-info h4 {\r\n  margin: 0;\r\n  font-size: 1rem;\r\n  color: #333;\r\n}\r\n\r\n.shopping-info p {\r\n  margin: 0;\r\n  font-size: 0.8rem;\r\n  color: #666;\r\n}\r\n/*fim do modal*/\r\n/* container do rodap√© (onde ficam os bot√µes) */\r\n.shops-menu-root .menu-footer {\r\n  display: grid;\r\n  gap: 10px;\r\n  padding: 10px 0px;\r\n}\r\n\r\n/* bot√£o base */\r\n.shopping-selector-btn {\r\n  width: 100%;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 10px;\r\n  padding: 10px 12px;\r\n  border: 1px solid #E6E6EF;\r\n  background: #FFFFFF;\r\n  color: #2F2A3B;\r\n  border-radius: 12px;\r\n  box-shadow: 0 2px 10px rgba(31, 28, 53, 0.06);\r\n  cursor: pointer;\r\n  transition: background .15s ease, border-color .15s ease, transform .06s ease, box-shadow .15s ease;\r\n  font: 500 14px/1 Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\r\n}\r\n\r\n/* conte√∫do do bot√£o */\r\n.shopping-selector-btn .menu-icon-wrap {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 28px; height: 28px;\r\n  border-radius: 8px;\r\n  background: #F4F1FF;\r\n  color: #5B3CC4; /* roxo do seu topo */\r\n}\r\n\r\n.shopping-selector-btn .menu-label {\r\n  flex: 1 1 auto;\r\n  text-align: left;\r\n  white-space: nowrap;\r\n}\r\n\r\n.shopping-selector-btn .menu-kicker {\r\n  font-size: 12px;\r\n  color: #7C7A8A;\r\n  background: #F7F7FB;\r\n  border: 1px solid #EDECF5;\r\n  padding: 3px 6px;\r\n  border-radius: 8px;\r\n}\r\n\r\n/* estados */\r\n.shopping-selector-btn:hover {\r\n  background: #F7F4FF;\r\n  border-color: #D8CEFF;\r\n  box-shadow: 0 4px 18px rgba(91, 60, 196, 0.12);\r\n}\r\n.shopping-selector-btn:active {\r\n  transform: translateY(1px);\r\n  box-shadow: 0 2px 10px rgba(91, 60, 196, 0.10);\r\n}\r\n.shopping-selector-btn:focus-visible {\r\n  outline: 3px solid rgba(123, 93, 251, .4);\r\n  outline-offset: 2px;\r\n}\r\n\r\n/* desabilitado (se quiser usar em algum momento) */\r\n.shopping-selector-btn[disabled] {\r\n  opacity: .55;\r\n  cursor: not-allowed;\r\n}\r\n\r\n/* quando o menu estiver recolhido (classe .collapsed j√° existe no seu c√≥digo) */\r\n.shops-menu-root.collapsed .shopping-selector-btn {\r\n  justify-content: center;\r\n  padding: 10px;\r\n}\r\n.shops-menu-root.collapsed .shopping-selector-btn .menu-label,\r\n.shops-menu-root.collapsed .shopping-selector-btn .menu-kicker {\r\n  display: none;\r\n}\r\n.shops-menu-root.collapsed .shopping-selector-btn .menu-icon-wrap {\r\n  width: 34px; height: 34px;\r\n  border-radius: 10px;\r\n}\r\n/*css do bort√£o trocar shopping fim */\r\n.shopping-modal {\r\n  position: fixed;\r\n  inset: 0;\r\n  z-index: 9999;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  opacity: 0;\r\n  pointer-events: none;\r\n  transition: opacity .2s ease;\r\n  font-family: \"Inter\", sans-serif;\r\n}\r\n\r\n.shopping-modal.show {\r\n  opacity: 1;\r\n  pointer-events: auto;\r\n}\r\n\r\n.shopping-modal-overlay {\r\n  position: absolute;\r\n  inset: 0;\r\n  background: rgba(0,0,0,0.45);\r\n  backdrop-filter: blur(3px);\r\n}\r\n\r\n.shopping-modal-window {\r\n  position: relative;\r\n  z-index: 2;\r\n  background: #fff;\r\n  width: 400px;\r\n  max-width: 90%;\r\n  border-radius: 16px;\r\n  box-shadow: 0 8px 30px rgba(0,0,0,0.2);\r\n  overflow: hidden;\r\n  transform: translateY(-10px);\r\n  transition: transform .25s ease;\r\n}\r\n\r\n.shopping-modal.show .shopping-modal-window {\r\n  transform: translateY(0);\r\n}\r\n\r\n.shopping-modal-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  background: #5B3CC4;\r\n  color: #fff;\r\n  padding: 12px 18px;\r\n}\r\n\r\n.shopping-modal-header h3 {\r\n  font-size: 1.1rem;\r\n  margin: 0;\r\n}\r\n\r\n.close-btn {\r\n  background: none;\r\n  border: none;\r\n  color: #fff;\r\n  font-size: 22px;\r\n  cursor: pointer;\r\n  transition: transform .2s;\r\n}\r\n\r\n.close-btn:hover {\r\n  transform: scale(1.1);\r\n}\r\n\r\n.shopping-modal-body {\r\n  padding: 16px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10px;\r\n}\r\n\r\n.shopping-option {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 10px;\r\n  padding: 10px 14px;\r\n  cursor: pointer;\r\n  transition: all .2s;\r\n  background: #fafafa;\r\n}\r\n\r\n.shopping-option:hover {\r\n  background: #f3ebff;\r\n  border-color: #7b5dfb;\r\n  transform: scale(1.02);\r\n}\r\n\r\n.shopping-icon {\r\n  font-size: 26px;\r\n}\r\n\r\n.shopping-info h4 {\r\n  margin: 0;\r\n  font-size: 1rem;\r\n  color: #333;\r\n}\r\n\r\n.shopping-info p {\r\n  margin: 0;\r\n  font-size: 0.8rem;\r\n  color: #666;\r\n}\r\n\r\n\r\n.shops-menu-root{\r\n  --brand: #3E1A7D;        /* ativo */\r\n  --ghost: ghostwhite;     /* texto no ativo */\r\n  --hover-bg: #efe7ff;     /* hover (roxo claro) */\r\n  --text: #111827;         /* texto padr√£o */\r\n  --divider: #e5e7eb;      /* linha divis√≥ria */\r\n  --radius: 10px;\r\n}\r\n\r\n/* Escopo local das cores */\r\n.shops-menu-root {\r\n  --brand: #3E1A7D;                  /* cor MYIO para ativo */\r\n  --ghost: ghostwhite;               /* texto no ativo */\r\n  --hover-bg: #efe7ff;               /* hover suave */\r\n  --text: #111827;                   /* texto padr√£o */\r\n  --user-color: #2d1458;             /* cor sutil para info do usu√°rio */\r\n  --radius: 10px;\r\n\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 16px 0;\r\n  box-sizing: border-box;\r\n}\r\n\r\n/* User info section at the top */\r\n.user-info {\r\n  padding: 12px 16px 16px;\r\n  border-bottom: 1px solid var(--divider);\r\n  margin-bottom: 8px;\r\n}\r\n\r\n/* Rodap√© do menu: for√ßa 1 coluna cheia */\r\n.shops-menu-root .menu-footer {\r\n  display: grid;               /* pode ser flex, mas grid d√° menos surpresas */\r\n  grid-template-columns: 1fr;  /* garante 1 coluna ocupando 100% */\r\n  gap: 10px;\r\n  padding: 10px 0px;          /* padding sim√©trico */\r\n  box-sizing: border-box;\r\n}\r\n\r\n/* O bot√£o precisa esticar 100% da coluna e zerar margens */\r\n#shopping-selector-btn.shopping-selector-btn {\r\n  justify-self: stretch;       /* estica no grid */\r\n  align-self: center;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n  margin: 0;                   /* evita ‚Äúpuxar‚Äù para a direita */\r\n}\r\n\r\n/* Conte√∫do interno permanece como antes */\r\n.shopping-selector-btn {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 10px;\r\n  padding: 10px 12px;\r\n  border: 1px solid #E6E6EF;\r\n  background: #FFFFFF;\r\n  color: #2F2A3B;\r\n  border-radius: 12px;\r\n  box-shadow: 0 2px 10px rgba(31, 28, 53, 0.06);\r\n  cursor: pointer;\r\n  transition: background .15s ease, border-color .15s ease, transform .06s ease, box-shadow .15s ease;\r\n  font: 500 14px/1 Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\r\n}\r\n\r\n/* quando o menu estiver recolhido, continua centrado */\r\n.shops-menu-root.collapsed #shopping-selector-btn {\r\n  justify-self: center;        /* centraliza quando colapsado */\r\n  width: auto;                 /* deixa o bot√£o ‚Äúcompacto‚Äù */\r\n}\r\n\r\n\r\n.user-name {\r\n  color: var(--user-color);\r\n  font-size: 15px;\r\n  font-weight: 600;\r\n  margin-bottom: 4px;\r\n  word-wrap: break-word;\r\n}\r\n\r\n.user-email {\r\n  color: var(--user-color);\r\n  font-size: 12px;\r\n  font-weight: 400;\r\n  opacity: 0.7;\r\n  word-wrap: break-word;\r\n}\r\n\r\n.menu-header {\r\n  display: flex; align-items: center; gap: 8px;\r\n  padding-bottom: 10px; border-bottom: 1px solid #eee;\r\n}\r\n\r\n.hamburger-btn {\r\n  background: none;\r\n  border: 0;\r\n  font-size: 14px;\r\n  cursor: pointer;\r\n  transition: transform 0.3s ease;\r\n}\r\n\r\n.hamburger-btn:hover {\r\n  transform: scale(1.1);\r\n}\r\n\r\n.hamburger-btn:active {\r\n  transform: scale(0.95);\r\n}\r\n\r\n/* lista em coluna, com divisores */\r\n.menu-list{\r\n  display:flex; flex-direction:column;\r\n  padding-top:12px; gap:0; /* gap 0 pq o divisor j√° separa */\r\n  flex: 1; /* Takes remaining space, pushing footer to bottom */\r\n  overflow-y: auto; /* Allows scrolling if menu items overflow */\r\n}\r\n\r\n/* cada item ocupa 100% da largura da linha */\r\n.menu-item{\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  width:100%;\r\n  padding:12px 16px;\r\n  color:var(--text);\r\n  text-decoration:none;\r\n  border-bottom:1px solid var(--divider) !important; /* padroniza divisor */\r\n  border-radius: var(--radius);\r\n  transition: background .2s ease, color .2s ease, box-shadow .2s ease;\r\n}\r\n\r\n.menu-icon {\r\n  font-size: 20px;\r\n  display: inline-block;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.menu-item {\r\n  text-decoration: none;\r\n  color: var(--text, #111827);\r\n  font-size: 16px;\r\n}\r\n\r\n/* texto/√≠cones herdam a cor do item */\r\n.menu-item .label{ display:inline-block; }\r\n\r\n/* se ainda aparecer um tra√ßo roxo legado, for√ßa remover: */\r\n.menu-item{ border-image:none !important; }\r\n\r\n/* fundo no hover pega a LINHA TODA */\r\n.menu-item:hover{\r\n  background:var(--hover-bg);\r\n}\r\n\r\n.menu-item.active .label {\r\n  background: var(--brand, #3E1A7D);\r\n  color: var(--ghost, #F8F8FF);\r\n  box-shadow: 0 2px 0 rgba(62, 26, 125, .35);\r\n}\r\n\r\n/* fundo no ativo pega a LINHA TODA */\r\n.menu-item.active {\r\n  background:var(--brand);\r\n  color:var(--ghost);\r\n  border-bottom-color: transparent; /* evita ‚Äúrisco‚Äù roxo sob o ativo */\r\n  box-shadow: 0 1px 0 rgba(62,26,125,.20) inset;\r\n}\r\n\r\n/* opcional: √≠cone + texto alinhados, caso adicione √≠cones no futuro */\r\n.menu-item .label > .icon {\r\n  margin-right: 8px;\r\n  display: inline-block;\r\n  vertical-align: -2px;\r\n}\r\n\r\n/* Logout button section */\r\n.menu-footer {\r\n  margin-top: auto;\r\n  padding: 16px 0 0;\r\n  border-top: 1px solid var(--divider);\r\n}\r\n\r\n.logout-btn {\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 8px;\r\n  padding: 12px 16px;\r\n  border: none;\r\n  border-radius: var(--radius);\r\n  background: transparent;\r\n  color: #dc2626; /* red-600 */\r\n  font-size: 16px;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: background 0.2s ease, color 0.2s ease;\r\n}\r\n\r\n.logout-btn:hover {\r\n  background: #fef2f2; /* red-50 */\r\n  color: #991b1b; /* red-800 */\r\n}\r\n\r\n.logout-btn:active {\r\n  background: #fee2e2; /* red-100 */\r\n}\r\n\r\n.logout-btn:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.logout-icon {\r\n  font-size: 20px;\r\n  display: inline-block;\r\n}\r\n\r\n.logout-text {\r\n  font-weight: 500;\r\n}\r\n\r\n/* ============================================\r\n   COLLAPSED MENU STATE (menu recolhido)\r\n   ============================================ */\r\n\r\n.shops-menu-root.collapsed {\r\n  width: 20px;\r\n}\r\n\r\n/* Hide text elements when collapsed */\r\n.shops-menu-root.collapsed .user-name,\r\n.shops-menu-root.collapsed .user-email,\r\n.shops-menu-root.collapsed .menu-item .label,\r\n.shops-menu-root.collapsed .logout-text {\r\n  display: none;\r\n}\r\n\r\n/* Adjust user info when collapsed */\r\n.shops-menu-root.collapsed .user-info {\r\n  padding: 12px 8px;\r\n  text-align: center;\r\n}\r\n\r\n/* Center hamburger button when collapsed */\r\n.shops-menu-root.collapsed .menu-header {\r\n  justify-content: center;\r\n  padding-bottom: 10px;\r\n}\r\n\r\n/* Center menu items when collapsed */\r\n.shops-menu-root.collapsed .menu-item {\r\n  padding: 12px 8px;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  gap: 4px;\r\n}\r\n\r\n/* Center logout button when collapsed */\r\n.shops-menu-root.collapsed .logout-btn {\r\n  padding: 12px 8px;\r\n  justify-content: center;\r\n}\r\n\r\n.shops-menu-root.collapsed .logout-icon {\r\n  margin: 0;\r\n}\r\n\r\n/* ============================================\r\n   RFC-0055: SHOPPING SELECTOR MODAL\r\n   ============================================ */\r\n\r\n/* Shopping selector menu item */\r\n.menu-item.shopping-selector {\r\n  cursor: pointer;\r\n}\r\n\r\n.menu-item.shopping-selector:hover {\r\n  background: var(--hover-bg);\r\n}\r\n\r\n/* Modal container */\r\n.shopping-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 10000;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  opacity: 0;\r\n  transition: opacity 0.3s ease;\r\n}\r\n\r\n.shopping-modal.show {\r\n  opacity: 1;\r\n}\r\n\r\n.shopping-modal.closing {\r\n  opacity: 0;\r\n}\r\n\r\n/* Modal overlay */\r\n.shopping-modal-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  backdrop-filter: blur(2px);\r\n}\r\n\r\n/* Modal content box */\r\n.shopping-modal-content {\r\n  position: relative;\r\n  background: white;\r\n  border-radius: 12px;\r\n  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);\r\n  max-width: 500px;\r\n  width: 90%;\r\n  max-height: 80vh;\r\n  overflow: hidden;\r\n  transform: scale(0.9);\r\n  transition: transform 0.3s ease;\r\n}\r\n\r\n.shopping-modal.show .shopping-modal-content {\r\n  transform: scale(1);\r\n}\r\n\r\n.shopping-modal.closing .shopping-modal-content {\r\n  transform: scale(0.9);\r\n}\r\n\r\n/* Modal header */\r\n.shopping-modal-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 20px 24px;\r\n  border-bottom: 1px solid var(--divider);\r\n  background: var(--brand);\r\n  color: var(--ghost);\r\n}\r\n\r\n.shopping-modal-header h2 {\r\n  margin: 0;\r\n  font-size: 20px;\r\n  font-weight: 600;\r\n}\r\n\r\n.shopping-modal-close {\r\n  background: none;\r\n  border: none;\r\n  color: var(--ghost);\r\n  font-size: 28px;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  padding: 0;\r\n  width: 32px;\r\n  height: 32px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 4px;\r\n  transition: background 0.2s ease;\r\n}\r\n\r\n.shopping-modal-close:hover {\r\n  background: rgba(255, 255, 255, 0.1);\r\n}\r\n\r\n/* Modal body */\r\n.shopping-modal-body {\r\n  padding: 24px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16px;\r\n}\r\n\r\n/* Shopping option cards */\r\n.shopping-option {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16px;\r\n  padding: 20px;\r\n  border: 2px solid var(--divider);\r\n  border-radius: var(--radius);\r\n  cursor: pointer;\r\n  transition: all 0.2s ease;\r\n  background: white;\r\n}\r\n\r\n.shopping-option:hover {\r\n  border-color: var(--brand);\r\n  background: var(--hover-bg);\r\n  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.shopping-option:active {\r\n  transform: translateY(0);\r\n  box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.shopping-icon {\r\n  font-size: 32px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.shopping-name {\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n  color: var(--text);\r\n}\r\n\r\n/* Layout do bot√£o \"Trocar Shopping\" refinado */\r\n.shopping-selector-btn {\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;        /* organiza em coluna */\r\n  align-items: flex-start;       /* alinha √† esquerda */\r\n  justify-content: center;\r\n  gap: 2px;\r\n  padding: 10px 12px;\r\n  border: 1px solid #E6E6EF;\r\n  background: #FFFFFF;\r\n  color: #2F2A3B;\r\n  border-radius: 12px;\r\n  box-shadow: 0 2px 10px rgba(31, 28, 53, 0.06);\r\n  cursor: pointer;\r\n  transition: all .15s ease;\r\n  font-family: \"Inter\", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\r\n}\r\n\r\n/* primeira linha (\"Trocar Shopping\") */\r\n.shopping-selector-btn .menu-label {\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n}\r\n\r\n/* segunda linha (nome do shopping) */\r\n.shopping-selector-btn .current-shopping {\r\n  font-size: 12.5px;\r\n  font-weight: 500;\r\n  color: #5B3CC4;      /* roxo principal */\r\n  opacity: 0.9;\r\n  text-transform: none;\r\n  line-height: 1.2;\r\n  margin-left: 26px;   /* alinha com o √≠cone */\r\n}\r\n\r\n/* √≠cone visualmente equilibrado √† esquerda */\r\n.shopping-selector-btn .menu-icon-wrap {\r\n  position: absolute;\r\n  left: 10px;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n}\r\n\r\n/* mant√©m comportamento normal em modo colapsado */\r\n.shops-menu-root.collapsed .shopping-selector-btn {\r\n  flex-direction: row;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.shops-menu-root.collapsed .shopping-selector-btn .current-shopping {\r\n  display: none;\r\n}\r\n.shopping-selector-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  width: 100%;\r\n  padding: 10px 12px;\r\n  border-radius: 12px;\r\n  border: 1px solid #E6E6EF;\r\n  background: #FFFFFF;\r\n  box-shadow: 0 2px 10px rgba(31, 28, 53, 0.06);\r\n  cursor: pointer;\r\n  transition: .15s;\r\n}\r\n\r\n.menu-btn-content {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.menu-icon-wrap {\r\n  background: #F4F1FF;\r\n  color: #5B3CC4;\r\n  padding: 6px;\r\n  border-radius: 8px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.menu-text {\r\n  display: flex;\r\n  flex-direction: column;\r\n  line-height: 1.2;\r\n}\r\n\r\n.menu-label {\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n}\r\n\r\n.current-shopping {\r\n  font-size: 12px;\r\n  font-weight: 500;\r\n  color: #5B3CC4;\r\n  opacity: .9;\r\n}\r\n\r\n.menu-kicker {\r\n  font-size: 12px;\r\n  color: #7C7A8A;\r\n  background: #F7F7FB;\r\n  border-radius: 6px;\r\n  padding: 3px 6px;\r\n}\r\n\r\n.shops-menu-root.collapsed .current-shopping,\r\n.shops-menu-root.collapsed .menu-kicker {\r\n  display: none;\r\n}\r\n\r\n/* container do rodap√© */\r\n.shops-menu-root .menu-footer{\r\n  display:grid;\r\n  grid-template-columns: 1fr;\r\n  gap:10px;\r\n  padding:10px 12px;\r\n  box-sizing:border-box;\r\n}\r\n\r\n/* bot√£o */\r\n#shopping-selector-btn.shopping-selector-btn{\r\n  width:100%;\r\n  margin:0;\r\n  box-sizing:border-box;\r\n  padding:12px;\r\n  border-radius:14px;\r\n  border:1px solid #E6E6EF;\r\n  background: #FFFFFF;\r\n  box-shadow: 0 2px 10px rgba(31,28,53,.06);\r\n  cursor:pointer;\r\n  transition: transform .06s ease, box-shadow .15s ease, border-color .15s ease, background .15s ease;\r\n}\r\n\r\n/* grade interna: √≠cone | texto (2 linhas) | atalho */\r\n#shopping-selector-btn .ssb-grid{\r\n  display:grid;\r\n  grid-template-columns: 36px 1fr auto;\r\n  align-items:center;\r\n  column-gap:12px;\r\n}\r\n\r\n/* √≠cone ‚Äúp√≠lula‚Äù */\r\n#shopping-selector-btn .ssb-icon{\r\n  width:36px; height:36px;\r\n  display:flex; align-items:center; justify-content:center;\r\n  border-radius:10px;\r\n  background:#F3EEFF;\r\n  color:#5B3CC4;\r\n  font-size:18px;\r\n}\r\n\r\n/* bloco de texto */\r\n#shopping-selector-btn .ssb-text{\r\n  display:flex; flex-direction:column; min-width:0; line-height:1.15;\r\n}\r\n#shopping-selector-btn .ssb-title{\r\n  font: 600 14px/1.1 Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\r\n  color:#2F2A3B;\r\n}\r\n#shopping-selector-btn .ssb-sub{\r\n  margin-top:2px;\r\n  font: 500 12.5px/1.1 Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\r\n  color:#5B3CC4;\r\n  opacity:.95;\r\n  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;\r\n}\r\n\r\n/* atalho (keycap) */\r\n#shopping-selector-btn .ssb-kbd{\r\n  font: 500 12px/1 Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\r\n  color:#7C7A8A;\r\n  background:#F7F7FB;\r\n  border:1px solid #EDECF5;\r\n  padding:4px 6px;\r\n  border-radius:8px;\r\n  white-space:nowrap;\r\n}\r\n\r\n/* estados */\r\n#shopping-selector-btn:hover{\r\n  background:#F8F6FF;\r\n  border-color:#D8CEFF;\r\n  box-shadow:0 4px 18px rgba(91,60,196,.12);\r\n}\r\n#shopping-selector-btn:active{\r\n  transform:translateY(1px);\r\n  box-shadow:0 2px 10px rgba(91,60,196,.10);\r\n}\r\n#shopping-selector-btn:focus-visible{\r\n  outline:3px solid rgba(123,93,251,.45);\r\n  outline-offset:2px;\r\n}\r\n\r\n/* menu recolhido: vers√£o compacta */\r\n.shops-menu-root.collapsed #shopping-selector-btn .ssb-sub,\r\n.shops-menu-root.collapsed #shopping-selector-btn .ssb-kbd{\r\n  display:none;\r\n}\r\n.shops-menu-root.collapsed #shopping-selector-btn .ssb-grid{\r\n  grid-template-columns: 36px auto;\r\n  justify-content:center;\r\n}\r\n\r\n/* Permitir que o nome do shopping quebre linha sem cortar */\r\n.ssb-text {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n  line-height: 1.2;\r\n}\r\n\r\n/* Nome do shopping completo */\r\n#ssb-current-shopping {\r\n  font-size: 0.82rem;\r\n  color: #6A5ACD;\r\n  font-weight: 500;\r\n  white-space: normal;     /* ‚Üê remove o truncamento */\r\n  overflow: visible;\r\n  text-overflow: unset;\r\n  word-break: break-word;  /* ‚Üê quebra para caber bonito */\r\n  max-width: 140px;        /* ajuste fino para evitar empurrar o teclado */\r\n}\r\n\r\n/* Mant√©m o layout do bot√£o organizado */\r\n.shopping-selector-btn .ssb-grid {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 6px;\r\n}\r\n\r\n\r\n/* RFC-0085: Temperature Settings Button */\r\n#temp-settings-btn.temp-settings-btn {\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  padding: 12px;\r\n  border-radius: 14px;\r\n  border: 1px solid #E6E6EF;\r\n  background: #FFFFFF;\r\n  color: #2F2A3B;\r\n  box-shadow: 0 2px 10px rgba(31, 28, 53, 0.06);\r\n  cursor: pointer;\r\n  transition: transform 0.06s ease, box-shadow 0.15s ease, border-color 0.15s ease, background 0.15s ease;\r\n  font: 500 14px/1 Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\r\n  box-sizing: border-box;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n#temp-settings-btn .temp-icon {\r\n  width: 36px;\r\n  height: 36px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 10px;\r\n  background: #FFF3E0;\r\n  color: #E65100;\r\n  font-size: 18px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n#temp-settings-btn .temp-text {\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: #2F2A3B;\r\n}\r\n\r\n#temp-settings-btn:hover {\r\n  background: #FFF8E1;\r\n  border-color: #FFE0B2;\r\n  box-shadow: 0 4px 18px rgba(230, 81, 0, 0.12);\r\n}\r\n\r\n#temp-settings-btn:active {\r\n  transform: translateY(1px);\r\n  box-shadow: 0 2px 10px rgba(230, 81, 0, 0.10);\r\n}\r\n\r\n#temp-settings-btn:focus-visible {\r\n  outline: 3px solid rgba(255, 152, 0, 0.45);\r\n  outline-offset: 2px;\r\n}\r\n\r\n/* Collapsed state */\r\n.shops-menu-root.collapsed #temp-settings-btn .temp-text {\r\n  display: none;\r\n}\r\n\r\n.shops-menu-root.collapsed #temp-settings-btn {\r\n  justify-content: center;\r\n  padding: 10px;\r\n}\r\n\r\n/* RFC-0107: Contract Devices Button */\r\n#contract-devices-btn.contract-devices-btn {\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  padding: 12px;\r\n  border-radius: 14px;\r\n  border: 1px solid #E6E6EF;\r\n  background: #FFFFFF;\r\n  color: #2F2A3B;\r\n  box-shadow: 0 2px 10px rgba(31, 28, 53, 0.06);\r\n  cursor: pointer;\r\n  transition: transform 0.06s ease, box-shadow 0.15s ease, border-color 0.15s ease, background 0.15s ease;\r\n  font: 500 14px/1 Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\r\n  box-sizing: border-box;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n#contract-devices-btn .contract-icon {\r\n  width: 36px;\r\n  height: 36px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 10px;\r\n  background: #E8F5E9;\r\n  color: #2E7D32;\r\n  font-size: 18px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n#contract-devices-btn .contract-text {\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: #2F2A3B;\r\n}\r\n\r\n#contract-devices-btn:hover {\r\n  background: #E8F5E9;\r\n  border-color: #A5D6A7;\r\n  box-shadow: 0 4px 18px rgba(46, 125, 50, 0.12);\r\n}\r\n\r\n#contract-devices-btn:active {\r\n  transform: translateY(1px);\r\n  box-shadow: 0 2px 10px rgba(46, 125, 50, 0.10);\r\n}\r\n\r\n#contract-devices-btn:focus-visible {\r\n  outline: 3px solid rgba(76, 175, 80, 0.45);\r\n  outline-offset: 2px;\r\n}\r\n\r\n/* Collapsed state */\r\n.shops-menu-root.collapsed #contract-devices-btn .contract-text {\r\n  display: none;\r\n}\r\n\r\n.shops-menu-root.collapsed #contract-devices-btn {\r\n  justify-content: center;\r\n  padding: 10px;\r\n}\r\n\r\n/* RFC-0108: Measurement Setup Button */\r\n#measurement-setup-btn.measurement-setup-btn {\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  padding: 12px;\r\n  border-radius: 14px;\r\n  border: 1px solid #E6E6EF;\r\n  background: #FFFFFF;\r\n  color: #2F2A3B;\r\n  box-shadow: 0 2px 10px rgba(31, 28, 53, 0.06);\r\n  cursor: pointer;\r\n  transition: transform 0.06s ease, box-shadow 0.15s ease, border-color 0.15s ease, background 0.15s ease;\r\n  font: 500 14px/1 Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\r\n  box-sizing: border-box;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n#measurement-setup-btn .measurement-icon {\r\n  width: 36px;\r\n  height: 36px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 10px;\r\n  background: #EDE7F6;\r\n  color: #5E35B1;\r\n  font-size: 18px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n#measurement-setup-btn .measurement-text {\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: #2F2A3B;\r\n}\r\n\r\n#measurement-setup-btn:hover {\r\n  background: #EDE7F6;\r\n  border-color: #B39DDB;\r\n  box-shadow: 0 4px 18px rgba(94, 53, 177, 0.12);\r\n}\r\n\r\n#measurement-setup-btn:active {\r\n  transform: translateY(1px);\r\n  box-shadow: 0 2px 10px rgba(94, 53, 177, 0.10);\r\n}\r\n\r\n#measurement-setup-btn:focus-visible {\r\n  outline: 3px solid rgba(103, 58, 183, 0.45);\r\n  outline-offset: 2px;\r\n}\r\n\r\n/* Collapsed state */\r\n.shops-menu-root.collapsed #measurement-setup-btn .measurement-text {\r\n  display: none;\r\n}\r\n\r\n.shops-menu-root.collapsed #measurement-setup-btn {\r\n  justify-content: center;\r\n  padding: 10px;\r\n}\r\n\r\n/* RFC-0108: Consolidated Settings Menu Button */\r\n#settings-menu-btn.settings-menu-btn {\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  padding: 12px;\r\n  border-radius: 14px;\r\n  border: 1px solid #E6E6EF;\r\n  background: #FFFFFF;\r\n  color: #2F2A3B;\r\n  box-shadow: 0 2px 10px rgba(31, 28, 53, 0.06);\r\n  cursor: pointer;\r\n  transition: transform 0.06s ease, box-shadow 0.15s ease, border-color 0.15s ease, background 0.15s ease;\r\n  font: 500 14px/1 Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\r\n  box-sizing: border-box;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n#settings-menu-btn .settings-menu-icon {\r\n  width: 36px;\r\n  height: 36px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 10px;\r\n  background: #F3E5F5;\r\n  color: #7B1FA2;\r\n  font-size: 18px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n#settings-menu-btn .settings-menu-text {\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: #2F2A3B;\r\n}\r\n\r\n#settings-menu-btn:hover {\r\n  background: #F3E5F5;\r\n  border-color: #CE93D8;\r\n  box-shadow: 0 4px 18px rgba(123, 31, 162, 0.12);\r\n}\r\n\r\n#settings-menu-btn:active {\r\n  transform: translateY(1px);\r\n  box-shadow: 0 2px 10px rgba(123, 31, 162, 0.10);\r\n}\r\n\r\n#settings-menu-btn:focus-visible {\r\n  outline: 3px solid rgba(156, 39, 176, 0.45);\r\n  outline-offset: 2px;\r\n}\r\n\r\n/* Collapsed state */\r\n.shops-menu-root.collapsed #settings-menu-btn .settings-menu-text {\r\n  display: none;\r\n}\r\n\r\n.shops-menu-root.collapsed #settings-menu-btn {\r\n  justify-content: center;\r\n  padding: 10px;\r\n}\r\n\r\n/* RFC-0108: Settings Modal Styles */\r\n.myio-settings-modal {\r\n  position: fixed;\r\n  inset: 0;\r\n  z-index: 100000;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  opacity: 0;\r\n  pointer-events: none;\r\n  transition: opacity 0.2s ease;\r\n  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\r\n}\r\n\r\n.myio-settings-modal.show {\r\n  opacity: 1;\r\n  pointer-events: auto;\r\n}\r\n\r\n.myio-settings-modal__overlay {\r\n  position: absolute;\r\n  inset: 0;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  backdrop-filter: blur(4px);\r\n}\r\n\r\n.myio-settings-modal__content {\r\n  position: relative;\r\n  z-index: 2;\r\n  background: #FFFFFF;\r\n  border-radius: 16px;\r\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);\r\n  width: min(400px, 90vw);\r\n  max-height: 90vh;\r\n  overflow: hidden;\r\n  transform: translateY(10px) scale(0.98);\r\n  transition: transform 0.2s ease;\r\n}\r\n\r\n.myio-settings-modal.show .myio-settings-modal__content {\r\n  transform: translateY(0) scale(1);\r\n}\r\n\r\n.myio-settings-modal__header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 16px 20px;\r\n  background: linear-gradient(135deg, #7B1FA2, #9C27B0);\r\n  color: white;\r\n}\r\n\r\n.myio-settings-modal__header h3 {\r\n  margin: 0;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.myio-settings-modal__close {\r\n  background: transparent;\r\n  border: none;\r\n  color: white;\r\n  font-size: 24px;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  padding: 4px;\r\n  border-radius: 4px;\r\n  transition: background 0.15s ease;\r\n}\r\n\r\n.myio-settings-modal__close:hover {\r\n  background: rgba(255, 255, 255, 0.15);\r\n}\r\n\r\n.myio-settings-modal__body {\r\n  padding: 16px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10px;\r\n}\r\n\r\n.myio-settings-option {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 14px;\r\n  padding: 14px 16px;\r\n  border: 1px solid #E5E7EB;\r\n  border-radius: 12px;\r\n  background: #FAFAFA;\r\n  cursor: pointer;\r\n  transition: all 0.15s ease;\r\n  text-align: left;\r\n  width: 100%;\r\n}\r\n\r\n.myio-settings-option:hover {\r\n  background: #F3E5F5;\r\n  border-color: #CE93D8;\r\n  transform: translateX(4px);\r\n  box-shadow: 0 4px 12px rgba(123, 31, 162, 0.1);\r\n}\r\n\r\n.myio-settings-option:active {\r\n  transform: translateX(2px);\r\n}\r\n\r\n.myio-settings-option__icon {\r\n  width: 44px;\r\n  height: 44px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 12px;\r\n  background: white;\r\n  font-size: 22px;\r\n  flex-shrink: 0;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\r\n}\r\n\r\n.myio-settings-option__text {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 2px;\r\n  min-width: 0;\r\n}\r\n\r\n.myio-settings-option__title {\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  color: #1F2937;\r\n}\r\n\r\n.myio-settings-option__desc {\r\n  font-size: 12px;\r\n  color: #6B7280;\r\n  line-height: 1.3;\r\n}\r\n\r\n/* Responsive adjustments */\r\n@media (max-width: 640px) {\r\n  .shopping-modal-content {\r\n    width: 95%;\r\n    max-width: none;\r\n  }\r\n\r\n  .shopping-modal-body {\r\n    padding: 16px;\r\n  }\r\n\r\n  .shopping-option {\r\n    padding: 16px;\r\n  }\r\n\r\n  .shopping-icon {\r\n    font-size: 28px;\r\n  }\r\n\r\n  .shopping-name {\r\n    font-size: 16px;\r\n  }\r\n}\r\n",
      "controllerScript": "/* global self, window, document, localStorage, sessionStorage, requestAnimationFrame */\n\n// RFC-0091: Use shared LogHelper from MAIN widget via window.MyIOUtils\nconst LogHelper = window.MyIOUtils?.LogHelper || {\n  log: (...args) => console.log(...args),\n  warn: (...args) => console.warn(...args),\n  error: (...args) => console.error(...args),\n};\n\nself.onInit = function () {\n  const settings = self.ctx.settings || {};\n  const scope = self.ctx.$scope;\n\n  scope.links = settings.links || [];\n\n  // guarda √∫ltimo nome v√°lido para reaproveitar em edge cases\n  const STORAGE_KEY = 'myio:current-shopping-name';\n\n  function updateShoppingLabel() {\n    const name = getCurrentDashboardTitle();\n    setShoppingButtonLabel(name);\n  }\n\n  // pega o t√≠tulo do dashboard de forma resiliente (v√°rias vers√µes do TB)\n  function getCurrentDashboardTitle() {\n    // Primeiro tenta pegar do dashboard (caso um dia algu√©m ative o t√≠tulo)\n    const name =\n      self.ctx?.dashboard?.title ||\n      self.ctx?.dashboard?.dashboard?.title ||\n      self.ctx?.dashboard?.config?.title ||\n      self.ctx?.dashboard?.configuration?.title ||\n      null;\n\n    console.log('self.ctx?.dashboard', self.ctx?.dashboard)\n    console.log('Dashboard title found:', name);\n    console.log('Datasources:', self.ctx?.datasources);\n\n    if (name) return name;\n\n    // ‚úÖ Se n√£o estiver no dashboard, pega do datasource principal\n    try {\n      const ds = self.ctx?.datasources?.[0];\n      if (ds?.name) return ds.name.trim();\n    } catch {\n      // Ignore datasource access errors\n    }\n\n    return null;\n  }\n\n  function setShoppingButtonLabel(name) {\n    const el = document.getElementById('ssb-current-shopping');\n    if (!el) return;\n    const has = !!(name && name.trim());\n    el.textContent = has ? name.trim() : '';\n    el.style.display = has ? 'block' : 'none';\n  }\n\n  // chama e persiste o nome atual\n  function updateShoppingLabelFromDashboard() {\n    const title = getCurrentDashboardTitle();\n    if (title) {\n      setShoppingButtonLabel(title);\n      try {\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(title));\n      } catch {\n        // Ignore localStorage errors (quota exceeded, private mode, etc.)\n      }\n    } else {\n      setShoppingButtonLabel(null);\n    }\n  }\n\n  // Function to get icon for each menu item based on stateId\n  scope.getMenuIcon = function (stateId) {\n    const icons = {\n      telemetry_content: '‚ö°',\n      water_content: 'üíß',\n      temperature_content: 'üå°Ô∏è',\n      alarm_content: 'üîî',\n    };\n    return icons[stateId] || 'üìÑ';\n  };\n\n  // Hamburger menu toggle\n  const hamburgerBtn = document.querySelector('.hamburger-btn');\n  const menuRoot = document.querySelector('.shops-menu-root');\n  let isMenuCollapsed = false;\n\n  if (hamburgerBtn && menuRoot) {\n    hamburgerBtn.addEventListener('click', function (e) {\n      e.preventDefault();\n      isMenuCollapsed = !isMenuCollapsed;\n\n      if (isMenuCollapsed) {\n        menuRoot.classList.add('collapsed');\n        LogHelper.log('[MENU] Menu collapsed');\n      } else {\n        menuRoot.classList.remove('collapsed');\n        LogHelper.log('[MENU] Menu expanded');\n      }\n\n      // Emit event to notify other widgets (like MAIN_VIEW)\n      window.dispatchEvent(\n        new CustomEvent('myio:menu-toggle', {\n          detail: { collapsed: isMenuCollapsed },\n        })\n      );\n    });\n  }\n\n  // Fetch and display user info\n  fetchUserInfo();\n\n  async function fetchUserInfo() {\n    // helper local para montar headers sem enviar \"Bearer null\"\n    function buildAuthHeaders() {\n      const token = localStorage.getItem('jwt_token');\n      const headers = { 'Content-Type': 'application/json' };\n      if (token) headers['X-Authorization'] = 'Bearer ' + token;\n      return headers;\n    }\n\n    try {\n      const response = await fetch('/api/auth/user', {\n        method: 'GET',\n        headers: buildAuthHeaders(),\n        credentials: 'include',\n      });\n\n      if (!response.ok) {\n        LogHelper.warn('[MENU] /api/auth/user status:', response.status);\n        if (response.status === 401) {\n          // token expirado/invalidado ‚Üí for√ßa login\n          localStorage.removeItem('jwt_token');\n          sessionStorage.clear();\n          window.location.href = '/login';\n          return;\n        }\n        throw new Error(`Failed to fetch user info: ${response.status}`);\n      }\n\n      const user = await response.json();\n      console.log('user >>>>>>>>>>>>>>>>', user);\n\n      // Atualiza UI do usu√°rio imediatamente (mesmo que a busca de atributos falhe)\n      const userNameEl = document.getElementById('user-name');\n      const userEmailEl = document.getElementById('user-email');\n\n      if (userNameEl) {\n        const fullName = `${user.firstName || ''} ${user.lastName || ''}`.trim() || user.name || 'Usu√°rio';\n        userNameEl.textContent = fullName;\n      }\n      if (userEmailEl && user?.email) {\n        userEmailEl.textContent = user.email;\n      }\n\n      // RFC-0064: Check if user is TENANT_ADMIN first (skip attributes fetch)\n      let isUserAdmin = false;\n      if (user.authority === 'TENANT_ADMIN') {\n        LogHelper.log('[MENU] User is TENANT_ADMIN - granting admin access without attributes check');\n        isUserAdmin = true;\n      } else {\n        // Busca atributos do CUSTOMER (pode dar 400/404 quando n√£o existem atributos)\n        try {\n          const attrRes = await fetch(\n            `/api/plugins/telemetry/CUSTOMER/${user.customerId.id}/values/attributes/SERVER_SCOPE`,\n            {\n              method: 'GET',\n              headers: buildAuthHeaders(),\n              credentials: 'include',\n            }\n          );\n\n          if (attrRes.ok) {\n            // pode vir vazio ou n√£o-JSON em alguns casos; defenda o parse\n            const userAttributes = await attrRes.json().catch(() => []);\n            LogHelper.log('[MENU] User attributes received:', userAttributes);\n\n            if (Array.isArray(userAttributes)) {\n              for (const attr of userAttributes) {\n                if (attr && attr.key === 'isUserAdmin') {\n                  isUserAdmin = !!attr.value;\n                  break;\n                }\n              }\n            }\n          } else if (attrRes.status === 400 || attrRes.status === 404) {\n            // Sem atributos ‚Üí segue fluxo normal\n            LogHelper.warn('[MENU] CUSTOMER attributes not found (400/404). Proceeding without admin.');\n          } else if (attrRes.status === 401) {\n            // token expirado durante a segunda chamada\n            localStorage.removeItem('jwt_token');\n            sessionStorage.clear();\n            window.location.href = '/login';\n            return;\n          } else {\n            LogHelper.warn('[MENU] Unexpected attributes status:', attrRes.status);\n          }\n        } catch (attrErr) {\n          // N√£o quebre a exibi√ß√£o do usu√°rio por causa dos atributos\n          LogHelper.warn('[MENU] Ignoring attributes error:', attrErr);\n        }\n      } // End of else block (non-TENANT_ADMIN users)\n\n      // Habilita bot√£o de troca de shopping apenas para admin\n      if (isUserAdmin) {\n        LogHelper.log('[MENU] User admin detected - enabling shopping selector and settings buttons');\n        addShoppingSelectorButton();\n        addSettingsMenuButton(user); // RFC-0108: Consolidated settings menu\n        updateShoppingLabel();\n      }\n    } catch (err) {\n      LogHelper.error('[MENU] Error fetching user info:', err);\n\n      // Fallback UI\n      const userNameEl = document.getElementById('user-name');\n      const userEmailEl = document.getElementById('user-email');\n\n      if (userNameEl) userNameEl.textContent = 'Usu√°rio';\n      if (userEmailEl) userEmailEl.textContent = '';\n    }\n  }\n\n  // RFC-0042: State ID to Domain mapping\n  const DOMAIN_BY_STATE = {\n    telemetry_content: 'energy',\n    water_content: 'water',\n    temperature_content: 'temperature',\n    alarm_content: null, // No domain for alarms\n  };\n\n  scope.changeDashboardState = function (e, stateId, index) {\n    e.preventDefault();\n\n    // Marca o link selecionado e desmarca os outros\n    scope.links.forEach((link, i) => (link.enableLink = i === index));\n\n    // RFC-0042: Notify orchestrator of tab change\n    const domain = DOMAIN_BY_STATE[stateId];\n\n    // ALWAYS dispatch event, even for null domain (alarms, etc)\n    // This ensures HEADER can disable buttons for unsupported domains\n    //LogHelper.log(`[MENU] Tab changed to domain: ${domain || 'null (unsupported)'}`);\n    window.dispatchEvent(\n      new CustomEvent('myio:dashboard-state', {\n        detail: { tab: domain },\n      })\n    );\n\n    // RFC-0053: Navega√ß√£o via Estados do ThingsBoard (preferido)\n    try {\n      if (self.ctx?.dashboard && typeof self.ctx.dashboard.openDashboardState === 'function') {\n        LogHelper.log(`[MENU] RFC-0053: Navegando para estado TB: ${stateId}`);\n        self.ctx.dashboard.openDashboardState(stateId);\n        return; // j√° navegou via TB; n√£o usar fallback\n      }\n    } catch (err) {\n      LogHelper.warn('[MENU] RFC-0053: openDashboardState indispon√≠vel:', err);\n    }\n\n    // RFC-0053: Use content containers with show/hide logic (no iframes!)\n    try {\n      const main = document.getElementsByTagName('main')[0];\n      if (!main) {\n        LogHelper.error('[MENU] <main> element not found in DOM');\n        return;\n      }\n\n      // Find all content containers with data-content-state attribute\n      const allContents = main.querySelectorAll('[data-content-state]');\n\n      if (allContents.length === 0) {\n        LogHelper.error('[MENU] No content containers found with data-content-state attribute');\n        main.innerHTML = `<div style=\"padding: 20px; text-align: center; color: #666;\">\n          <p><strong>Error: Content containers not configured</strong></p>\n          <p>Expected containers with data-content-state attribute in MAIN_VIEW template.html</p>\n        </div>`;\n        return;\n      }\n\n      // Hide all content containers\n      allContents.forEach((content) => {\n        content.style.display = 'none';\n      });\n\n      // Show target container\n      const targetContent = main.querySelector(`[data-content-state=\"${stateId}\"]`);\n      if (targetContent) {\n        targetContent.style.display = 'block';\n        LogHelper.log(`[MENU] ‚úÖ RFC-0053: Showing content container for ${stateId} (no iframe!)`);\n      } else {\n        LogHelper.warn(`[MENU] Content container not found for ${stateId}`);\n        main.innerHTML = `<div style=\"padding: 20px; text-align: center; color: #ff6b6b;\">\n          <p><strong>State \"${stateId}\" not configured</strong></p>\n          <p>Available containers: ${Array.from(allContents)\n            .map((c) => c.getAttribute('data-content-state'))\n            .join(', ')}</p>\n        </div>`;\n      }\n    } catch (err) {\n      LogHelper.error('[MENU] RFC-0053: Failed to switch content container:', err);\n    }\n  };\n\n  // Logout handler\n  scope.handleLogout = async function (e) {\n    e.preventDefault();\n\n    //LogHelper.log(\"[MENU] Logout button clicked\");\n\n    // Confirm before logout\n    const confirmed = window.confirm('Tem certeza que deseja sair?');\n    if (!confirmed) {\n      LogHelper.log('[MENU] Logout cancelled by user');\n      return;\n    }\n\n    const logoutBtn = document.getElementById('logout-btn');\n    if (logoutBtn) {\n      logoutBtn.disabled = true;\n      logoutBtn.querySelector('.logout-text').textContent = 'Saindo...';\n    }\n\n    try {\n      //LogHelper.log(\"[MENU] Sending logout request to /api/auth/logout\");\n\n      const response = await fetch('/api/auth/logout', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-Authorization': 'Bearer ' + localStorage.getItem('jwt_token'),\n        },\n        credentials: 'include',\n      });\n\n      //LogHelper.log(\"[MENU] Logout response status:\", response.status);\n\n      if (response.ok || response.status === 200 || response.status === 401) {\n        // Clear local storage\n        LogHelper.log('[MENU] Clearing local storage and session data');\n        localStorage.removeItem('jwt_token');\n        sessionStorage.clear();\n\n        // Clear orchestrator cache if available\n        if (window.MyIOOrchestrator) {\n          try {\n            window.MyIOOrchestrator.invalidateCache('*');\n            LogHelper.log('[MENU] Orchestrator cache cleared');\n          } catch (err) {\n            LogHelper.warn('[MENU] Failed to clear orchestrator cache:', err);\n          }\n        }\n\n        LogHelper.log('[MENU] Redirecting to login page');\n\n        // Redirect to login page\n        window.location.href = '/login';\n      } else {\n        throw new Error(`Logout failed with status: ${response.status}`);\n      }\n    } catch (err) {\n      LogHelper.error('[MENU] Logout error:', err);\n      window.alert('Erro ao fazer logout. Voc√™ ser√° redirecionado para a tela de login.');\n\n      // Force redirect even on error\n      localStorage.removeItem('jwt_token');\n      sessionStorage.clear();\n      window.location.href = '/login';\n    } finally {\n      if (logoutBtn) {\n        logoutBtn.disabled = false;\n        logoutBtn.querySelector('.logout-text').textContent = 'Sair';\n      }\n    }\n  };\n\n  // RFC-0108: Consolidated Settings Menu Button\n  function addSettingsMenuButton(user) {\n    if (document.getElementById('settings-menu-btn')) {\n      LogHelper.log('[MENU] Settings menu button already exists');\n      return;\n    }\n\n    const menuFooter = document.querySelector('.shops-menu-root .menu-footer');\n    const logoutBtn = document.getElementById('logout-btn');\n    if (!menuFooter) {\n      LogHelper.error('[MENU] Menu footer not found - cannot add settings menu button');\n      return;\n    }\n\n    const settingsMenuBtn = document.createElement('button');\n    settingsMenuBtn.id = 'settings-menu-btn';\n    settingsMenuBtn.className = 'settings-menu-btn';\n    settingsMenuBtn.type = 'button';\n    settingsMenuBtn.setAttribute('aria-label', 'Configura√ß√µes');\n\n    settingsMenuBtn.innerHTML = `\n      <span class=\"settings-menu-icon\">‚öôÔ∏è</span>\n      <span class=\"settings-menu-text\">Configura√ß√µes</span>\n    `;\n\n    // Insert before logout button\n    if (logoutBtn) menuFooter.insertBefore(settingsMenuBtn, logoutBtn);\n    else menuFooter.appendChild(settingsMenuBtn);\n\n    // Click handler - show settings modal\n    settingsMenuBtn.addEventListener('click', () => {\n      LogHelper.log('[MENU] Settings menu button clicked');\n      showSettingsModal(user);\n    });\n\n    LogHelper.log('[MENU] Settings menu button added successfully');\n  }\n\n  // RFC-0108: Show centered settings modal with options\n  function showSettingsModal(user) {\n    // Use top-level document to ensure modal appears above everything\n    const topWin = window.top || window;\n    const topDoc = (() => {\n      try {\n        return topWin.document;\n      } catch {\n        return document;\n      }\n    })();\n\n    // Inject styles if not present\n    const STYLE_ID = 'myio-settings-modal-styles';\n    if (!topDoc.getElementById(STYLE_ID)) {\n      const style = topDoc.createElement('style');\n      style.id = STYLE_ID;\n      style.textContent = `\n        .myio-settings-modal {\n          position: fixed;\n          inset: 0;\n          z-index: 999999;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          opacity: 0;\n          pointer-events: none;\n          transition: opacity 0.2s ease;\n          font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\n        }\n        .myio-settings-modal.show {\n          opacity: 1;\n          pointer-events: auto;\n        }\n        .myio-settings-modal__overlay {\n          position: absolute;\n          inset: 0;\n          background: rgba(0, 0, 0, 0.5);\n          backdrop-filter: blur(4px);\n        }\n        .myio-settings-modal__content {\n          position: relative;\n          z-index: 2;\n          background: #FFFFFF;\n          border-radius: 16px;\n          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);\n          width: min(400px, 90vw);\n          max-height: 90vh;\n          overflow: hidden;\n          transform: translateY(10px) scale(0.98);\n          transition: transform 0.2s ease;\n        }\n        .myio-settings-modal.show .myio-settings-modal__content {\n          transform: translateY(0) scale(1);\n        }\n        .myio-settings-modal__header {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          padding: 16px 20px;\n          background: linear-gradient(135deg, #7B1FA2, #9C27B0);\n          color: white;\n        }\n        .myio-settings-modal__header h3 {\n          margin: 0;\n          font-size: 16px;\n          font-weight: 600;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n        .myio-settings-modal__close {\n          background: transparent;\n          border: none;\n          color: white;\n          font-size: 24px;\n          line-height: 1;\n          cursor: pointer;\n          padding: 4px;\n          border-radius: 4px;\n          transition: background 0.15s ease;\n        }\n        .myio-settings-modal__close:hover {\n          background: rgba(255, 255, 255, 0.15);\n        }\n        .myio-settings-modal__body {\n          padding: 16px;\n          display: flex;\n          flex-direction: column;\n          gap: 10px;\n        }\n        .myio-settings-option {\n          display: flex;\n          align-items: center;\n          gap: 14px;\n          padding: 14px 16px;\n          border: 1px solid #E5E7EB;\n          border-radius: 12px;\n          background: #FAFAFA;\n          cursor: pointer;\n          transition: all 0.15s ease;\n          text-align: left;\n          width: 100%;\n        }\n        .myio-settings-option:hover {\n          background: #F3E5F5;\n          border-color: #CE93D8;\n          transform: translateX(4px);\n          box-shadow: 0 4px 12px rgba(123, 31, 162, 0.1);\n        }\n        .myio-settings-option:active {\n          transform: translateX(2px);\n        }\n        .myio-settings-option__icon {\n          width: 44px;\n          height: 44px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          border-radius: 12px;\n          background: white;\n          font-size: 22px;\n          flex-shrink: 0;\n          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n        }\n        .myio-settings-option__text {\n          display: flex;\n          flex-direction: column;\n          gap: 2px;\n          min-width: 0;\n        }\n        .myio-settings-option__title {\n          font-size: 14px;\n          font-weight: 600;\n          color: #1F2937;\n        }\n        .myio-settings-option__desc {\n          font-size: 12px;\n          color: #6B7280;\n          line-height: 1.3;\n        }\n      `;\n      topDoc.head.appendChild(style);\n    }\n\n    // Remove existing modal if any\n    const existingModal = topDoc.getElementById('myio-settings-modal');\n    if (existingModal) existingModal.remove();\n\n    const modal = topDoc.createElement('div');\n    modal.id = 'myio-settings-modal';\n    modal.className = 'myio-settings-modal';\n    modal.innerHTML = `\n      <div class=\"myio-settings-modal__overlay\"></div>\n      <div class=\"myio-settings-modal__content\">\n        <div class=\"myio-settings-modal__header\">\n          <h3>‚öôÔ∏è Configura√ß√µes</h3>\n          <button class=\"myio-settings-modal__close\" aria-label=\"Fechar\">&times;</button>\n        </div>\n        <div class=\"myio-settings-modal__body\">\n          <button class=\"myio-settings-option\" data-action=\"temperature\">\n            <span class=\"myio-settings-option__icon\">üå°Ô∏è</span>\n            <div class=\"myio-settings-option__text\">\n              <span class=\"myio-settings-option__title\">Config. Temperatura</span>\n              <span class=\"myio-settings-option__desc\">Limites e alertas de temperatura</span>\n            </div>\n          </button>\n          <button class=\"myio-settings-option\" data-action=\"contract\">\n            <span class=\"myio-settings-option__icon\">üìã</span>\n            <div class=\"myio-settings-option__text\">\n              <span class=\"myio-settings-option__title\">Dispositivos Contratados</span>\n              <span class=\"myio-settings-option__desc\">Quantidade de dispositivos por dom√≠nio</span>\n            </div>\n          </button>\n          <button class=\"myio-settings-option\" data-action=\"measurement\">\n            <span class=\"myio-settings-option__icon\">üìê</span>\n            <div class=\"myio-settings-option__text\">\n              <span class=\"myio-settings-option__title\">Config. Medidas</span>\n              <span class=\"myio-settings-option__desc\">Unidades e casas decimais</span>\n            </div>\n          </button>\n        </div>\n      </div>\n    `;\n\n    topDoc.body.appendChild(modal);\n\n    // Animate in\n    requestAnimationFrame(() => modal.classList.add('show'));\n\n    // Close handlers\n    const closeModal = () => {\n      modal.classList.remove('show');\n      setTimeout(() => modal.remove(), 200);\n    };\n\n    modal.querySelector('.myio-settings-modal__overlay').addEventListener('click', closeModal);\n    modal.querySelector('.myio-settings-modal__close').addEventListener('click', closeModal);\n\n    // ESC key to close\n    const escHandler = (e) => {\n      if (e.key === 'Escape') {\n        closeModal();\n        topDoc.removeEventListener('keydown', escHandler);\n      }\n    };\n    topDoc.addEventListener('keydown', escHandler);\n\n    // Option click handlers\n    modal.querySelectorAll('.myio-settings-option').forEach((btn) => {\n      btn.addEventListener('click', () => {\n        const action = btn.dataset.action;\n        closeModal();\n\n        // Small delay to let modal close animation complete\n        setTimeout(() => {\n          if (action === 'temperature') {\n            openTemperatureSettings(user);\n          } else if (action === 'contract') {\n            openContractDevicesSettings(user);\n          } else if (action === 'measurement') {\n            openMeasurementSettings(user);\n          }\n        }, 250);\n      });\n    });\n\n    LogHelper.log('[MENU] Settings modal opened');\n  }\n\n  // RFC-0108: Open temperature settings modal\n  function openTemperatureSettings(user) {\n    const MyIOLibrary = window.MyIOLibrary;\n    if (!MyIOLibrary?.openTemperatureSettingsModal) {\n      LogHelper.error('[MENU] openTemperatureSettingsModal not available');\n      window.alert('Componente de configura√ß√£o de temperatura n√£o dispon√≠vel.');\n      return;\n    }\n\n    const jwtToken = localStorage.getItem('jwt_token');\n    if (!jwtToken) {\n      window.alert('Token de autentica√ß√£o n√£o encontrado. Fa√ßa login novamente.');\n      return;\n    }\n\n    const customerId = window.MyIOOrchestrator?.customerTB_ID;\n    const customerName = user?.customerTitle || user?.customerName || getCurrentDashboardTitle() || 'Cliente';\n\n    if (!customerId) {\n      window.alert('ID do cliente n√£o encontrado. Verifique configura√ß√£o do dashboard.');\n      return;\n    }\n\n    MyIOLibrary.openTemperatureSettingsModal({\n      token: jwtToken,\n      customerId: customerId,\n      customerName: customerName,\n      theme: 'dark',\n      onSave: (settings) => {\n        LogHelper.log('[MENU] Temperature settings saved:', settings);\n        window.dispatchEvent(new CustomEvent('myio:temperature-settings-updated', { detail: settings }));\n      },\n      onClose: () => LogHelper.log('[MENU] Temperature settings modal closed'),\n    });\n  }\n\n  // RFC-0108: Open contract devices modal\n  function openContractDevicesSettings(user) {\n    const MyIOLibrary = window.MyIOLibrary;\n    if (!MyIOLibrary?.openContractDevicesModal) {\n      LogHelper.error('[MENU] openContractDevicesModal not available');\n      window.alert('Componente de dispositivos contratados n√£o dispon√≠vel.');\n      return;\n    }\n\n    const jwtToken = localStorage.getItem('jwt_token');\n    if (!jwtToken) {\n      window.alert('Token de autentica√ß√£o n√£o encontrado. Fa√ßa login novamente.');\n      return;\n    }\n\n    const customerId = window.MyIOOrchestrator?.customerTB_ID;\n    const customerName = user?.customerTitle || user?.customerName || getCurrentDashboardTitle() || 'Cliente';\n\n    if (!customerId) {\n      window.alert('ID do cliente n√£o encontrado. Verifique configura√ß√£o do dashboard.');\n      return;\n    }\n\n    MyIOLibrary.openContractDevicesModal({\n      customerId: customerId,\n      customerName: customerName,\n      jwtToken: jwtToken,\n      onSaved: (result) => {\n        LogHelper.log('[MENU] Contract devices saved:', result);\n        window.dispatchEvent(new CustomEvent('myio:contract-devices-updated', { detail: result }));\n      },\n      onClose: () => LogHelper.log('[MENU] Contract devices modal closed'),\n      onError: (error) => {\n        LogHelper.error('[MENU] Contract devices error:', error);\n        window.alert('Erro ao salvar: ' + (error.message || 'Erro desconhecido'));\n      },\n    });\n  }\n\n  // RFC-0108: Open measurement setup modal\n  function openMeasurementSettings(user) {\n    const MyIOLibrary = window.MyIOLibrary;\n    if (!MyIOLibrary?.openMeasurementSetupModal) {\n      LogHelper.error('[MENU] openMeasurementSetupModal not available');\n      window.alert('Componente de configura√ß√£o de medidas n√£o dispon√≠vel.');\n      return;\n    }\n\n    const jwtToken = localStorage.getItem('jwt_token');\n    if (!jwtToken) {\n      window.alert('Token de autentica√ß√£o n√£o encontrado. Fa√ßa login novamente.');\n      return;\n    }\n\n    const customerId = window.MyIOOrchestrator?.customerTB_ID;\n    if (!customerId) {\n      window.alert('ID do cliente n√£o encontrado. Verifique configura√ß√£o do dashboard.');\n      return;\n    }\n\n    const existingSettings = window.MyIOOrchestrator?.measurementDisplaySettings ||\n      (window.MyIOUtils?.measurementSettings ? {\n        water: { ...window.MyIOUtils.measurementSettings.water },\n        energy: { ...window.MyIOUtils.measurementSettings.energy },\n        temperature: { ...window.MyIOUtils.measurementSettings.temperature },\n      } : null);\n\n    MyIOLibrary.openMeasurementSetupModal({\n      token: jwtToken,\n      customerId: customerId,\n      existingSettings: existingSettings,\n      onSave: (settings) => {\n        LogHelper.log('[MENU] Measurement settings saved:', settings);\n        if (window.MyIOUtils?.updateMeasurementSettings) {\n          window.MyIOUtils.updateMeasurementSettings(settings);\n        }\n        if (window.MyIOOrchestrator) {\n          window.MyIOOrchestrator.measurementDisplaySettings = settings;\n        }\n        window.dispatchEvent(new CustomEvent('myio:measurement-settings-updated', { detail: settings }));\n      },\n      onClose: () => LogHelper.log('[MENU] Measurement setup modal closed'),\n    });\n  }\n\n  // RFC-0055: Add shopping selector button for sacavalcante.com.br users\n  function addShoppingSelectorButton() {\n    if (document.getElementById('shopping-selector-btn')) {\n      LogHelper.log('[MENU] Shopping selector button already exists');\n      return;\n    }\n\n    const menuFooter = document.querySelector('.shops-menu-root .menu-footer');\n    const logoutBtn = document.getElementById('logout-btn');\n    if (!menuFooter) {\n      LogHelper.error('[MENU] Menu footer not found - cannot add shopping selector');\n      return;\n    }\n\n    const shoppingSelectorBtn = document.createElement('button');\n    shoppingSelectorBtn.id = 'shopping-selector-btn';\n    shoppingSelectorBtn.className = 'shopping-selector-btn';\n    shoppingSelectorBtn.type = 'button';\n    shoppingSelectorBtn.setAttribute('aria-label', 'Trocar Shopping');\n\n    // detecta Mac uma vez e injeta direto no template\n    const isMac = /mac/i.test(navigator.userAgent);\n    shoppingSelectorBtn.innerHTML = `\n    <div class=\"ssb-grid\">\n      <span class=\"ssb-icon\" aria-hidden=\"true\">üè¨</span>\n      <div class=\"ssb-text\">\n        <span class=\"ssb-title\" style=\"display: none;\">Trocar Shopping</span>\n        <span class=\"ssb-sub\" id=\"ssb-current-shopping\"></span>\n      </div>\n      <span class=\"ssb-kbd\" aria-hidden=\"true\" style=\"display: none;\">${isMac ? '‚åòK' : 'Ctrl+K'}</span>\n    </div>\n  `;\n\n    if (logoutBtn) menuFooter.insertBefore(shoppingSelectorBtn, logoutBtn);\n    else menuFooter.appendChild(shoppingSelectorBtn);\n\n    // r√≥tulo inicial\n    updateShoppingLabelFromDashboard();\n\n    // clique\n    shoppingSelectorBtn.addEventListener('click', () => {\n      LogHelper.log('[MENU] Shopping selector clicked');\n      //showShoppingModal();\n    });\n\n    LogHelper.log('[MENU] Shopping selector button added successfully');\n  }\n\n  // RFC-0085: Add temperature settings button for admin users\n  function addTemperatureSettingsButton(user) {\n    if (document.getElementById('temp-settings-btn')) {\n      LogHelper.log('[MENU] Temperature settings button already exists');\n      return;\n    }\n\n    const menuFooter = document.querySelector('.shops-menu-root .menu-footer');\n    const logoutBtn = document.getElementById('logout-btn');\n    if (!menuFooter) {\n      LogHelper.error('[MENU] Menu footer not found - cannot add temperature settings');\n      return;\n    }\n\n    const tempSettingsBtn = document.createElement('button');\n    tempSettingsBtn.id = 'temp-settings-btn';\n    tempSettingsBtn.className = 'temp-settings-btn';\n    tempSettingsBtn.type = 'button';\n    tempSettingsBtn.setAttribute('aria-label', 'Configurar Temperatura');\n    // Styling handled by CSS in style.css (#temp-settings-btn.temp-settings-btn)\n\n    tempSettingsBtn.innerHTML = `\n      <span class=\"temp-icon\">üå°Ô∏è</span>\n      <span class=\"temp-text\">Config. Temperatura</span>\n    `;\n\n    // Insert before logout button\n    if (logoutBtn) menuFooter.insertBefore(tempSettingsBtn, logoutBtn);\n    else menuFooter.appendChild(tempSettingsBtn);\n\n    // Click handler\n    tempSettingsBtn.addEventListener('click', () => {\n      LogHelper.log('[MENU] Temperature settings clicked');\n\n      const MyIOLibrary = window.MyIOLibrary;\n      if (!MyIOLibrary?.openTemperatureSettingsModal) {\n        LogHelper.error('[MENU] openTemperatureSettingsModal not available');\n        window.alert('Componente de configura√ß√£o de temperatura n√£o dispon√≠vel.');\n        return;\n      }\n\n      const jwtToken = localStorage.getItem('jwt_token');\n      if (!jwtToken) {\n        window.alert('Token de autentica√ß√£o n√£o encontrado. Fa√ßa login novamente.');\n        return;\n      }\n\n      // RFC-0085: Get customerTB_ID from MAIN_VIEW orchestrator (single source of truth)\n      const customerId = window.MyIOOrchestrator?.customerTB_ID;\n      const customerName =\n        user?.customerTitle || user?.customerName || getCurrentDashboardTitle() || 'Cliente';\n\n      if (!customerId) {\n        LogHelper.error(\n          '[MENU] customerTB_ID not found in MyIOOrchestrator - ensure MAIN_VIEW is configured'\n        );\n        window.alert('ID do cliente n√£o encontrado. Verifique configura√ß√£o do dashboard.');\n        return;\n      }\n\n      LogHelper.log('[MENU] Opening temperature settings for customer:', { customerId, customerName });\n\n      MyIOLibrary.openTemperatureSettingsModal({\n        token: jwtToken,\n        customerId: customerId,\n        customerName: customerName,\n        theme: 'dark',\n        onSave: (settings) => {\n          LogHelper.log('[MENU] Temperature settings saved:', settings);\n          // Dispatch event to notify other widgets\n          window.dispatchEvent(\n            new CustomEvent('myio:temperature-settings-updated', {\n              detail: settings,\n            })\n          );\n        },\n        onClose: () => {\n          LogHelper.log('[MENU] Temperature settings modal closed');\n        },\n      });\n    });\n\n    LogHelper.log('[MENU] Temperature settings button added successfully');\n  }\n\n  // RFC-0107: Add contract devices button for admin users\n  function addContractDevicesButton(user) {\n    if (document.getElementById('contract-devices-btn')) {\n      LogHelper.log('[MENU] Contract devices button already exists');\n      return;\n    }\n\n    const menuFooter = document.querySelector('.shops-menu-root .menu-footer');\n    const logoutBtn = document.getElementById('logout-btn');\n    if (!menuFooter) {\n      LogHelper.error('[MENU] Menu footer not found - cannot add contract devices button');\n      return;\n    }\n\n    const contractDevicesBtn = document.createElement('button');\n    contractDevicesBtn.id = 'contract-devices-btn';\n    contractDevicesBtn.className = 'contract-devices-btn';\n    contractDevicesBtn.type = 'button';\n    contractDevicesBtn.setAttribute('aria-label', 'Dispositivos Contratados');\n\n    contractDevicesBtn.innerHTML = `\n      <span class=\"contract-icon\">üìã</span>\n      <span class=\"contract-text\">Dispositivos Contratados</span>\n    `;\n\n    // Insert before logout button\n    if (logoutBtn) menuFooter.insertBefore(contractDevicesBtn, logoutBtn);\n    else menuFooter.appendChild(contractDevicesBtn);\n\n    // Click handler\n    contractDevicesBtn.addEventListener('click', () => {\n      LogHelper.log('[MENU] Contract devices clicked');\n\n      const MyIOLibrary = window.MyIOLibrary;\n      if (!MyIOLibrary?.openContractDevicesModal) {\n        LogHelper.error('[MENU] openContractDevicesModal not available');\n        window.alert('Componente de dispositivos contratados nao disponivel.');\n        return;\n      }\n\n      const jwtToken = localStorage.getItem('jwt_token');\n      if (!jwtToken) {\n        window.alert('Token de autenticacao nao encontrado. Faca login novamente.');\n        return;\n      }\n\n      // RFC-0107: Get customerTB_ID from MAIN_VIEW orchestrator (single source of truth)\n      const customerId = window.MyIOOrchestrator?.customerTB_ID;\n      const customerName =\n        user?.customerTitle || user?.customerName || getCurrentDashboardTitle() || 'Cliente';\n\n      if (!customerId) {\n        LogHelper.error(\n          '[MENU] customerTB_ID not found in MyIOOrchestrator - ensure MAIN_VIEW is configured'\n        );\n        window.alert('ID do cliente nao encontrado. Verifique configuracao do dashboard.');\n        return;\n      }\n\n      LogHelper.log('[MENU] Opening contract devices modal for customer:', { customerId, customerName });\n\n      MyIOLibrary.openContractDevicesModal({\n        customerId: customerId,\n        customerName: customerName,\n        jwtToken: jwtToken,\n        onSaved: (result) => {\n          LogHelper.log('[MENU] Contract devices saved:', result);\n          // Dispatch event to notify other widgets\n          window.dispatchEvent(\n            new CustomEvent('myio:contract-devices-updated', {\n              detail: result,\n            })\n          );\n        },\n        onClose: () => {\n          LogHelper.log('[MENU] Contract devices modal closed');\n        },\n        onError: (error) => {\n          LogHelper.error('[MENU] Contract devices error:', error);\n          window.alert('Erro ao salvar: ' + (error.message || 'Erro desconhecido'));\n        },\n      });\n    });\n\n    LogHelper.log('[MENU] Contract devices button added successfully');\n  }\n\n  // RFC-0108: Add measurement setup button for admin users\n  function addMeasurementSetupButton(user) {\n    if (document.getElementById('measurement-setup-btn')) {\n      LogHelper.log('[MENU] Measurement setup button already exists');\n      return;\n    }\n\n    const menuFooter = document.querySelector('.shops-menu-root .menu-footer');\n    const logoutBtn = document.getElementById('logout-btn');\n    if (!menuFooter) {\n      LogHelper.error('[MENU] Menu footer not found - cannot add measurement setup button');\n      return;\n    }\n\n    const measurementSetupBtn = document.createElement('button');\n    measurementSetupBtn.id = 'measurement-setup-btn';\n    measurementSetupBtn.className = 'measurement-setup-btn';\n    measurementSetupBtn.type = 'button';\n    measurementSetupBtn.setAttribute('aria-label', 'Configurar Medidas');\n\n    measurementSetupBtn.innerHTML = `\n      <span class=\"measurement-icon\">üìê</span>\n      <span class=\"measurement-text\">Config. Medidas</span>\n    `;\n\n    // Insert before logout button\n    if (logoutBtn) menuFooter.insertBefore(measurementSetupBtn, logoutBtn);\n    else menuFooter.appendChild(measurementSetupBtn);\n\n    // Click handler\n    measurementSetupBtn.addEventListener('click', () => {\n      LogHelper.log('[MENU] Measurement setup clicked');\n\n      const MyIOLibrary = window.MyIOLibrary;\n      if (!MyIOLibrary?.openMeasurementSetupModal) {\n        LogHelper.error('[MENU] openMeasurementSetupModal not available');\n        window.alert('Componente de configura√ß√£o de medidas n√£o dispon√≠vel.');\n        return;\n      }\n\n      const jwtToken = localStorage.getItem('jwt_token');\n      if (!jwtToken) {\n        window.alert('Token de autentica√ß√£o n√£o encontrado. Fa√ßa login novamente.');\n        return;\n      }\n\n      // RFC-0108: Get customerTB_ID from MAIN_VIEW orchestrator (single source of truth)\n      const customerId = window.MyIOOrchestrator?.customerTB_ID;\n      const customerName =\n        user?.customerTitle || user?.customerName || getCurrentDashboardTitle() || 'Cliente';\n\n      if (!customerId) {\n        LogHelper.error(\n          '[MENU] customerTB_ID not found in MyIOOrchestrator - ensure MAIN_VIEW is configured'\n        );\n        window.alert('ID do cliente n√£o encontrado. Verifique configura√ß√£o do dashboard.');\n        return;\n      }\n\n      LogHelper.log('[MENU] Opening measurement setup modal for customer:', { customerId, customerName });\n\n      // RFC-0108: Get existing settings from orchestrator or MyIOUtils defaults\n      const existingSettings = window.MyIOOrchestrator?.measurementDisplaySettings ||\n        (window.MyIOUtils?.measurementSettings ? {\n          water: { ...window.MyIOUtils.measurementSettings.water },\n          energy: { ...window.MyIOUtils.measurementSettings.energy },\n          temperature: { ...window.MyIOUtils.measurementSettings.temperature },\n        } : null);\n\n      MyIOLibrary.openMeasurementSetupModal({\n        token: jwtToken,\n        customerId: customerId,\n        existingSettings: existingSettings,\n        onSave: (settings) => {\n          LogHelper.log('[MENU] Measurement settings saved:', settings);\n          // RFC-0108: Update MyIOUtils shared settings directly\n          if (window.MyIOUtils?.updateMeasurementSettings) {\n            window.MyIOUtils.updateMeasurementSettings(settings);\n          }\n          // Update orchestrator with new settings\n          if (window.MyIOOrchestrator) {\n            window.MyIOOrchestrator.measurementDisplaySettings = settings;\n          }\n          // Dispatch event to notify other widgets (TELEMETRY, MAIN_VIEW, etc.)\n          window.dispatchEvent(\n            new CustomEvent('myio:measurement-settings-updated', {\n              detail: settings,\n            })\n          );\n        },\n        onClose: () => {\n          LogHelper.log('[MENU] Measurement setup modal closed');\n        },\n      });\n    });\n\n    LogHelper.log('[MENU] Measurement setup button added successfully');\n  }\n\n  // RFC-0055: Show modal with shopping options\n  function showShoppingModal() {\n    // tenta usar o documento de n√≠vel mais alto (dashboard inteiro)\n    const topWin = window.top || window;\n    const topDoc = (() => {\n      try {\n        return topWin.document;\n      } catch {\n        // Cross-origin access may fail, fallback to current document\n        return document;\n      }\n    })();\n\n    const SCOPE = topDoc; // onde vamos injetar (top-level ou fallback)\n    const STYLE_ID = 'myio-shopping-modal-global-styles';\n    const MODAL_ID = 'myio-shopping-modal';\n\n    // remove se j√° existir\n    const old = SCOPE.getElementById(MODAL_ID);\n    if (old) old.remove();\n\n    // injeta css global uma √∫nica vez\n    if (!SCOPE.getElementById(STYLE_ID)) {\n      const style = SCOPE.createElement('style');\n      style.id = STYLE_ID;\n      style.textContent = `\n      /* overlay global, cobre a viewport toda */\n      .myio-modal {\n        position: fixed;\n        inset: 0;\n        z-index: 999999; /* bem alto pra passar por cima de tudo */\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        opacity: 0;\n        pointer-events: none;\n        transition: opacity .2s ease;\n        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\n      }\n      .myio-modal.show { opacity: 1; pointer-events: auto; }\n      .myio-modal__overlay {\n        position: absolute; inset: 0;\n        background: rgba(0,0,0,.55);\n        backdrop-filter: blur(3px);\n      }\n      .myio-modal__window {\n        position: relative; z-index: 2;\n        background: #fff;\n        width: min(480px, 92vw);\n        border-radius: 18px;\n        box-shadow: 0 18px 60px rgba(0,0,0,.35);\n        overflow: hidden;\n        transform: translateY(12px) scale(.98);\n        transition: transform .25s ease;\n      }\n      .myio-modal.show .myio-modal__window {\n        transform: translateY(0) scale(1);\n      }\n      .myio-modal__header {\n        display:flex; align-items:center; justify-content:space-between;\n        padding: 14px 18px;\n        background: #5B3CC4; color: #fff;\n      }\n      .myio-modal__header h3 { margin: 0; font-size: 1.05rem; font-weight: 600; }\n      .myio-modal__close {\n        background: transparent; border: 0; color: #fff;\n        font-size: 22px; line-height: 1; cursor: pointer;\n      }\n      .myio-modal__body {\n        padding: 14px;\n        display: grid; gap: 10px;\n      }\n      .myio-shop {\n        display:flex; align-items:center; gap: 12px;\n        background: #fafafa; border: 1px solid #e6e6e6;\n        border-radius: 12px; padding: 12px 14px; cursor:pointer;\n        transition: background .15s, transform .15s, border-color .15s;\n      }\n      .myio-shop:hover { background:#f2ecff; border-color:#7b5dfb; transform: translateY(-1px); }\n      .myio-shop__icon { font-size: 26px; }\n      .myio-shop__title { margin:0; font-size: 1rem; color:#222; }\n      .myio-shop__sub { margin:0; font-size:.8rem; color:#666; }\n      @media (max-width: 480px){\n        .myio-modal__window{ width: 94vw; }\n      }\n    `;\n      SCOPE.head.appendChild(style);\n    }\n\n    // cria o modal no topo\n    const modal = SCOPE.createElement('div');\n    modal.id = MODAL_ID;\n    modal.className = 'myio-modal';\n    modal.innerHTML = `\n    <div class=\"myio-modal__overlay\" role=\"presentation\"></div>\n    <div class=\"myio-modal__window\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"myio-modal-title\">\n      <div class=\"myio-modal__header\">\n        <h3 id=\"myio-modal-title\">Selecione o Shopping</h3>\n        <button class=\"myio-modal__close\" aria-label=\"Fechar\">&times;</button>\n      </div>\n      <div class=\"myio-modal__body\">\n        <div class=\"myio-shop\" data-url=\"https://dashboard.myio-bas.com/dashboards/all/ed5a0dd0-a3b7-11f0-afe1-175479a33d89\">\n          <div class=\"myio-shop__icon\">üè¢</div>\n          <div>\n            <p class=\"myio-shop__title\">Mestre √Ålvaro</p>\n            <p class=\"myio-shop__sub\">Vit√≥ria - ES</p>\n          </div>\n        </div>\n        <div class=\"myio-shop\" data-url=\"https://dashboard.myio-bas.com/dashboards/all/1e785950-af55-11f0-9722-210aa9448abc\">\n          <div class=\"myio-shop__icon\">üè¨</div>\n          <div>\n            <p class=\"myio-shop__title\">Mont Serrat</p>\n            <p class=\"myio-shop__sub\">Serra - ES</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  `;\n    SCOPE.body.appendChild(modal);\n\n    // bloqueia scroll do dashboard enquanto o modal est√° aberto\n    const prevOverflow = SCOPE.body.style.overflow;\n    SCOPE.body.style.overflow = 'hidden';\n\n    const overlay = modal.querySelector('.myio-modal__overlay');\n    const btnClose = modal.querySelector('.myio-modal__close');\n\n    const close = () => {\n      modal.classList.remove('show');\n      setTimeout(() => {\n        modal.remove();\n        SCOPE.body.style.overflow = prevOverflow || '';\n      }, 220);\n    };\n\n    overlay.addEventListener('click', close);\n    btnClose.addEventListener('click', close);\n    SCOPE.addEventListener('keydown', escCloseOnce, true);\n    function escCloseOnce(e) {\n      if (e.key === 'Escape') {\n        e.stopPropagation();\n        close();\n        SCOPE.removeEventListener('keydown', escCloseOnce, true);\n      }\n    }\n\n    modal.querySelectorAll('.myio-shop').forEach((el) => {\n      el.addEventListener('click', () => {\n        const url = el.getAttribute('data-url');\n        LogHelper.log('[MENU] Trocar shopping:', url);\n        close();\n        setTimeout(() => {\n          topWin.location.href = url;\n        }, 240);\n      });\n    });\n\n    // anima\n    requestAnimationFrame(() => modal.classList.add('show'));\n  }\n\n  // RFC-0056 FIX: Emit initial dashboard-state to prevent race condition\n  // The first link is usually the default (energy/telemetry)\n  // This ensures HEADER and other widgets know the initial domain immediately\n  setTimeout(() => {\n    const firstLink = scope.links && scope.links[0];\n    if (firstLink && firstLink.enableLink !== false) {\n      const firstStateId = firstLink.stateId || 'telemetry_content';\n      const firstDomain = DOMAIN_BY_STATE[firstStateId] || 'energy';\n\n      LogHelper.log(`[MENU] RFC-0056 FIX: Emitting initial dashboard-state for domain: ${firstDomain}`);\n\n      window.dispatchEvent(\n        new CustomEvent('myio:dashboard-state', {\n          detail: { tab: firstDomain },\n        })\n      );\n    } else {\n      // Fallback: emit energy as default\n      LogHelper.log(`[MENU] RFC-0056 FIX: No first link found, emitting default domain: energy`);\n\n      window.dispatchEvent(\n        new CustomEvent('myio:dashboard-state', {\n          detail: { tab: 'energy' },\n        })\n      );\n    }\n  }, 100); //Small delay to ensure HEADER is ready to listen\n\n  // === Atalho global para abrir o modal (Ctrl+K / ‚åòK) ===\n  (function attachGlobalHotkey() {\n    const topDoc = (window.top && window.top.document) || document;\n    const isEditable = (el) => el && (el.isContentEditable || /^(INPUT|TEXTAREA|SELECT)$/.test(el.tagName));\n\n    function onKeyDown(e) {\n      // Mac = meta (‚åò), Win/Linux = ctrl\n\n      const isMac = /mac/i.test(navigator.userAgent);\n      const meta = isMac ? e.metaKey : e.ctrlKey;\n\n      if (!meta) return;\n      // aceita 'k' min/mai√∫scula\n      if ((e.key && e.key.toLowerCase() === 'k') || e.code === 'KeyK') {\n        // n√£o acione se o foco estiver digitando em um campo\n        if (isEditable(e.target)) return;\n        e.preventDefault();\n        // TODO: showShoppingModal() disabled for now\n      }\n    }\n\n    topDoc.addEventListener('keydown', onKeyDown, true);\n\n    // garanta limpeza quando o widget sair\n    const oldDestroy = self.onDestroy;\n    self.onDestroy = function () {\n      try {\n        topDoc.removeEventListener('keydown', onKeyDown, true);\n      } catch {\n        // Ignore cleanup errors (topDoc may no longer be accessible)\n      }\n      if (typeof oldDestroy === 'function') oldDestroy();\n    };\n  })();\n};\n",
      "settingsSchema": "{\r\n    \"schema\": {\r\n        \"type\": \"object\",\r\n        \"title\": \"Settings\",\r\n        \"properties\": {\r\n            \"linkCount\": {\r\n                \"title\": \"N√∫mero de Links\",\r\n                \"type\": \"integer\",\r\n                \"minimum\": 1,\r\n                \"default\": 1\r\n            },\r\n            \"links\": {\r\n                \"type\": \"array\",\r\n                \"title\": \"Configura√ß√£o dos Links\",\r\n                \"items\": {\r\n                    \"type\": \"object\",\r\n                    \"properties\": {\r\n                        \"content\": {\r\n                            \"title\": \"Menu String\",\r\n                            \"type\": \"string\",\r\n                            \"default\": \"Menu Entry\"\r\n                        },\r\n                        \"stateId\": {\r\n                            \"title\": \"State ID\",\r\n                            \"type\": \"string\",\r\n                            \"default\": \"\"\r\n                        },\r\n                        \"enableLink\": {\r\n                            \"title\": \"Habilitar Link\",\r\n                            \"type\": \"boolean\",\r\n                            \"default\": false\r\n                        }\r\n                    }\r\n                },\r\n                \"minItems\": 1,\r\n                \"maxItems\": 5\r\n            }\r\n        }\r\n    }\r\n}",
      "dataKeySettingsSchema": "{}\n",
      "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"Attributes card\",\"decimals\":null}"
    },
    "externalId": null,
    "resources": null,
    "id": {
      "entityType": "WIDGET_TYPE",
      "id": "7dde51f0-a3b7-11f0-afe1-175479a33d89"
    },
    "scada": false,
    "tags": null
  },
  "relations": [],
  "attributes": {
    "SERVER_SCOPE": []
  }
}