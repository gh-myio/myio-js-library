/* ============================================================================
   Theme CSS Variables
   ============================================================================ */

#myio-root {
  --myio-radius: 16px;
  --sidebar-w: 260px;
  --sidebar-w-compact: 72px;

  /* Light mode defaults (levemente roxo) */
  --myio-bg: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 50%, #c4b5fd 100%);
  --myio-panel: #ffffff;
  --myio-border: #e2e8f0;
  --myio-text: #1e293b;
  --myio-text-muted: #64748b;
  --myio-primary: #7c3aed;
  --myio-accent: #8b5cf6;
}

/* Light mode explicit */
#myio-root[data-theme="light"] {
  --myio-bg: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 50%, #c4b5fd 100%);
  --myio-panel: #ffffff;
  --myio-border: #e2e8f0;
  --myio-text: #1e293b;
  --myio-text-muted: #64748b;
  --myio-primary: #7c3aed;
  --myio-accent: #8b5cf6;
}

/* Dark mode */
#myio-root[data-theme="dark"] {
  --myio-bg: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #1e1b4b 100%);
  --myio-panel: #1e293b;
  --myio-border: #334155;
  --myio-text: #f1f5f9;
  --myio-text-muted: #94a3b8;
  --myio-primary: #a78bfa;
  --myio-accent: #8b5cf6;
}

/* root + filhos ocupam 100% */
#myio-root.myio-grid,
#myio-root .tb-child,
#myio-root section[id$="Container"] {
  width: 100%;
  height: 100%;
}

/* GRID PRINCIPAL */
#myio-root.myio-grid {
  display: grid;
  grid-template-columns: var(--sidebar-w) 1fr;
  grid-template-rows: auto 1fr 46px;
  grid-template-areas:
    'sidebar header'
    'sidebar content'
    'footer footer';
  width: 100%;
  height: 100%;
  background: var(--myio-bg);
  overflow: hidden;
  gap: 8px;
  padding: 8px;
  box-sizing: border-box;
  transition: grid-template-columns 0.3s ease;
}

/* Áreas */
#myio-root .myio-sidebar {
  grid-area: sidebar;
  background: var(--myio-panel);
  border: 1px solid var(--myio-border);
  border-radius: var(--myio-radius);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  padding: 8px;
  margin: 0;
  box-sizing: border-box;
  overflow: hidden;
}

#myio-root .myio-content {
  grid-area: content;
  background: var(--myio-panel);
  border: 1px solid var(--myio-border);
  border-radius: var(--myio-radius);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  overflow: auto;
  height: 100%;
  min-height: 0; /* allow grid child to shrink and enable inner scroll */
  box-sizing: border-box;
  margin: 0 !important;
  padding: 0 !important;
  position: relative;
}

/* Garantir que os containers de conteúdo preencham a área disponível */
#myio-root .myio-content [data-content-state] {
  width: 100%;
  height: 100%;
  min-height: 400px;
  box-sizing: border-box;
  /* display é controlado por .myio-content-grid e inline styles */
}

#myio-root .myio-header {
  grid-area: header;
  background: var(--myio-panel);
  border: 1px solid var(--myio-border);
  border-radius: var(--myio-radius);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  padding: 12px 16px;
  margin: 0;
  min-height: 60px;
  display: flex;
  align-items: center;
  box-sizing: border-box;
}

#myio-root .myio-footer {
  grid-area: footer;
  height: 46px;
  min-height: 46px;
  max-height: 46px;
  overflow: visible;
  z-index: 1000;
  border-radius: var(--myio-radius);
}

/* Aparência comum - border-radius definido acima */

/* Neutralizador de states internos */
#myio-root .myio-sidebar .tb-child,
#myio-root .myio-sidebar section[id$="Container"] {
  width: 100%;
  height: 100%;
  margin: 0 !important;
  padding: 0 !important;
  display: flex;
  align-items: stretch;
  justify-content: stretch;
  overflow: visible;
}

#myio-root .myio-header .tb-child,
#myio-root .myio-header section[id$="Container"] {
  width: 100%;
  height: 100%;
  margin: 0 !important;
  padding: 0 !important;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  overflow: visible;
}

/* Widgets de content precisam de scroll - NÃO forçar overflow: visible */
#myio-root .myio-content .tb-child,
#myio-root .myio-content section[id$="Container"] {
  width: 100%;
  height: 100%;
  margin: 0 !important;
  padding: 0 !important;
  display: flex;
  align-items: stretch;
  justify-content: stretch;
  overflow: auto; /* ✅ MUDADO: permite scroll nos widgets */
}

/* ThingsBoard wrapper para widgets dinamicamente carregados */
#myio-root .myio-content .tb-child tb-dynamic-component,
#myio-root .myio-content .tb-child tb-dynamic-component > * {
  display: block;
  width: 100%;
  height: 100%;
  min-height: 400px;
}
#myio-root .myio-footer .tb-child,
#myio-root .myio-footer section[id$="Container"] {
  /* Remove o padding padrão do Gridster */
  padding: 0 !important;

  /* Aplica todo o estilo visual que estava no #myio-root .myio-footer */
  background: linear-gradient(90deg, #121a2b, #1c2743);
  border: 1px solid var(--myio-border);
  border-top: 2px solid #00e09e;
  border-radius: var(--myio-radius);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* wrapper interno (nível 1 e 2) */
#myio-root .myio-content .tb-child > :first-child,
#myio-root .myio-content .tb-child > :first-child > :first-child {
  margin-left: 0 !important;
  padding-left: 0 !important;
}

/* elementos internos comuns */
#myio-root .myio-content .tb-child > * {
  flex: 1 1 auto;
  width: 100%;
  max-width: none;
  height: 100%;
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

/* containers internos */
#myio-root .myio-content .tb-child .container,
#myio-root .myio-content .tb-child .content,
#myio-root .myio-content .tb-child .mat-card,
#myio-root .myio-content .tb-child .mat-mdc-card {
  width: 100%;
  max-width: none;
  margin: 0;
  box-sizing: border-box;
  background: transparent !important;
  box-shadow: none !important;
  padding: 0 !important;
  border-radius: 0 !important;
}

/* grids internos */
#myio-root .myio-content .tb-child .layout-row,
#myio-root .myio-content .tb-child .layout-column {
  width: 100%;
  max-width: none;
}

/* Scrollbar suave apenas no content */
#myio-root .myio-content::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}
#myio-root .myio-content::-webkit-scrollbar-track {
  background: transparent;
}

/* Menu compacto */
#myio-root.myio-grid.menu-compact {
  grid-template-columns: var(--sidebar-w-compact) 1fr;
}

#myio-root.myio-grid.menu-compact .myio-sidebar {
  width: var(--sidebar-w-compact);
  padding: 8px;
  overflow: hidden;
}

/* Transição suave para o sidebar */
#myio-root .myio-sidebar {
  transition: width 0.3s ease, padding 0.3s ease;
}

/* Menu dentro do sidebar compacto */
#myio-root.myio-grid.menu-compact .myio-sidebar .menu-shopping-container,
#myio-root.myio-grid.menu-compact .myio-sidebar .menu-shopping-container > * {
  width: 100% !important;
  overflow: hidden !important;
  background: transparent !important;
}

/* Responsivo */
@media (max-width: 1200px) {
  #myio-root {
    --sidebar-w: 260px;
  }
}
@media (max-width: 920px) {
  #myio-root.myio-grid {
    grid-template-columns: 1fr;
    grid-template-rows: auto 1fr; /* sidebar, content */
    grid-template-areas:
      'sidebar'
      'content';
  }
  #myio-root .myio-sidebar {
    border-right: none;
    border-bottom: 1px solid var(--myio-border);
  }
}

/* ajustes extras */
.shops-menu-root {
  padding: 8px 0; /* só vertical */
}

/* Menu Shopping component within sidebar */
#myio-root .myio-sidebar .menu-shopping-container {
  width: 100%;
  height: 100%;
  background: transparent !important;
  border-radius: var(--myio-radius, 12px);
  overflow: hidden;
}

/* Override menu background to be transparent in sidebar context */
#myio-root .myio-sidebar .menu-shopping-container > *,
#myio-root .myio-sidebar [class*="menu-shopping"],
#myio-root .myio-sidebar [class*="-container"] {
  background: transparent !important;
  --bg: transparent !important;
}

/* Header Shopping component */
#myio-root .myio-header .tbx-toolbar {
  width: 100%;
  height: 100%;
  padding: 0;
  background: transparent;
}

#myio-root .myio-content > * {
  margin: 0;
}

/* ============================================================================
   Content Layout - 4 columns (3 grids + info on right)
   ============================================================================ */

/* 4-column grid layout for energy/water content */
#myio-root .myio-content-4col {
  display: grid;
  grid-template-columns: repeat(3, 1fr) 320px;
  gap: 12px;
  width: 100%;
  height: 100%;
  min-height: 100%;
  padding: 12px;
  box-sizing: border-box;
  overflow: auto;
}

/* Each grid column (TelemetryGrid) */
#myio-root .myio-content-4col .myio-grid-column {
  min-height: 400px;
  height: 100%;
  width: 100%;
  background: var(--myio-panel, #1a1a2e);
  border-radius: var(--myio-radius, 12px);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* TelemetryInfo column - fixed width on right */
#myio-root .myio-content-4col .myio-info-column {
  width: 100%;
  min-height: 400px;
  height: 100%;
  background: var(--myio-panel, #1a1a2e);
  border-radius: var(--myio-radius, 12px);
  overflow: auto;
  display: flex;
  flex-direction: column;
}

/* TelemetryInfo component styling in column */
#myio-root .myio-info-column .telemetry-info-root {
  height: 100%;
  min-height: 400px;
  padding: 12px;
  border-radius: var(--myio-radius, 12px);
  display: flex;
  flex-direction: column;
}

/* TelemetryInfo single column layout in sidebar mode */
#myio-root .myio-info-column .info-grid {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* Cards stack vertically */
#myio-root .myio-info-column .info-card {
  width: 100%;
}

/* Chart at the bottom */
#myio-root .myio-info-column .info-card.chart-card {
  width: 100%;
  min-height: 200px;
}

/* Legacy support for myio-content-grid (temperature/alarm) */
#myio-root .myio-content-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 12px;
  width: 100%;
  height: auto;
  min-height: 400px;
  padding: 12px;
  box-sizing: border-box;
  overflow: auto;
}

#myio-root .myio-content-grid .myio-grid-column {
  min-height: 350px;
  width: 100%;
  background: var(--myio-panel, #1a1a2e);
  border-radius: var(--myio-radius, 12px);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* Full width column (for temperature/alarm) */
#myio-root .myio-grid-full {
  grid-column: 1 / -1;
  width: 100%;
}

/* Responsive: 2 columns + info on medium screens */
@media (max-width: 1400px) {
  #myio-root .myio-content-4col {
    grid-template-columns: repeat(2, 1fr) 280px;
  }
}

/* Responsive: 1 column + info on smaller screens */
@media (max-width: 1000px) {
  #myio-root .myio-content-4col {
    grid-template-columns: 1fr 260px;
  }
}

/* Responsive: stack all on mobile */
@media (max-width: 768px) {
  #myio-root .myio-content-4col {
    grid-template-columns: 1fr;
  }

  #myio-root .myio-content-4col .myio-info-column {
    min-height: 300px;
  }
}
